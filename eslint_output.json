[{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\api\\copilot\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\api\\team\\create-user\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\auth\\callback\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\automations\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\calendar\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"motion"},"fix":{"range":[52,91],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":5,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[110,117],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[316,362],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Calendar, Clock, Plus, ChevronLeft, ChevronRight, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { useCalendarEvents } from \"@/hooks/use-data\";\r\nimport { EventDialog } from \"@/components/calendar/event-dialog\";\r\nimport { format, isSameDay, parseISO } from \"date-fns\";\r\n\r\nexport default function CalendarPage() {\r\n    const { data: events, isLoading } = useCalendarEvents();\r\n    const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n    const [selectedDate, setSelectedDate] = useState<Date | null>(new Date());\r\n\r\n    // Generate calendar days\r\n    const today = new Date();\r\n    const currentMonth = today.toLocaleString(\"default\", { month: \"long\" });\r\n    const currentYear = today.getFullYear();\r\n\r\n    const daysInMonth = new Date(\r\n        today.getFullYear(),\r\n        today.getMonth() + 1,\r\n        0\r\n    ).getDate();\r\n    const firstDayOfMonth = new Date(\r\n        today.getFullYear(),\r\n        today.getMonth(),\r\n        1\r\n    ).getDay();\r\n\r\n    const calendarDays: (number | null)[] = [];\r\n    for (let i = 0; i < firstDayOfMonth; i++) {\r\n        calendarDays.push(null);\r\n    }\r\n    for (let i = 1; i <= daysInMonth; i++) {\r\n        calendarDays.push(i);\r\n    }\r\n\r\n    const getEventsForDay = (day: number) => {\r\n        if (!events) return [];\r\n        const date = new Date(currentYear, today.getMonth(), day);\r\n        return events.filter(event => isSameDay(parseISO(event.start_time), date));\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-8 max-w-[1600px] mx-auto space-y-8\">\r\n            <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight\">Calendar</h1>\r\n                    <p className=\"text-muted-foreground mt-1\">\r\n                        Manage your schedule and upcoming meetings\r\n                    </p>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    <Button variant=\"outline\" onClick={() => alert(\"Calendar sync: Connect your Google/Outlook calendar in Settings > Integrations\")}>\r\n                        <Calendar className=\"mr-2 h-4 w-4\" />\r\n                        Sync Calendar\r\n                    </Button>\r\n                    <Button onClick={() => setIsDialogOpen(true)}>\r\n                        <Plus className=\"mr-2 h-4 w-4\" />\r\n                        Add Event\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n                <div className=\"lg:col-span-3 space-y-6\">\r\n                    <Card>\r\n                        <CardHeader className=\"flex flex-row items-center justify-between\">\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <CardTitle className=\"text-xl\">\r\n                                    {currentMonth} {currentYear}\r\n                                </CardTitle>\r\n                                <div className=\"flex gap-1\">\r\n                                    <Button variant=\"outline\" size=\"icon\" className=\"h-8 w-8\">\r\n                                        <ChevronLeft className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                    <Button variant=\"outline\" size=\"icon\" className=\"h-8 w-8\">\r\n                                        <ChevronRight className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"flex gap-2\">\r\n                                <Button variant=\"ghost\" size=\"sm\">Day</Button>\r\n                                <Button variant=\"ghost\" size=\"sm\">Week</Button>\r\n                                <Button variant=\"secondary\" size=\"sm\">Month</Button>\r\n                            </div>\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"grid grid-cols-7 gap-px bg-muted rounded-lg overflow-hidden border\">\r\n                                {[\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"].map((day) => (\r\n                                    <div\r\n                                        key={day}\r\n                                        className=\"bg-background p-4 text-center text-sm font-medium text-muted-foreground\"\r\n                                    >\r\n                                        {day}\r\n                                    </div>\r\n                                ))}\r\n                                {calendarDays.map((day, index) => {\r\n                                    const dayEvents = day ? getEventsForDay(day) : [];\r\n                                    const isToday = day === today.getDate();\r\n\r\n                                    return (\r\n                                        <div\r\n                                            key={index}\r\n                                            className={cn(\r\n                                                \"bg-background min-h-[120px] p-2 transition-colors hover:bg-muted/50 relative group\",\r\n                                                !day && \"bg-muted/50\"\r\n                                            )}\r\n                                            onClick={() => {\r\n                                                if (day) {\r\n                                                    setSelectedDate(new Date(currentYear, today.getMonth(), day));\r\n                                                    setIsDialogOpen(true);\r\n                                                }\r\n                                            }}\r\n                                        >\r\n                                            {day && (\r\n                                                <>\r\n                                                    <div className=\"flex justify-between items-start mb-2\">\r\n                                                        <span\r\n                                                            className={cn(\r\n                                                                \"text-sm font-medium h-7 w-7 flex items-center justify-center rounded-full\",\r\n                                                                isToday\r\n                                                                    ? \"bg-primary text-primary-foreground\"\r\n                                                                    : \"text-muted-foreground\"\r\n                                                            )}\r\n                                                        >\r\n                                                            {day}\r\n                                                        </span>\r\n                                                        <Button\r\n                                                            variant=\"ghost\"\r\n                                                            size=\"icon\"\r\n                                                            className=\"h-6 w-6 opacity-0 group-hover:opacity-100 -mt-1 -mr-1\"\r\n                                                        >\r\n                                                            <Plus className=\"h-3 w-3\" />\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                    <div className=\"space-y-1\">\r\n                                                        {dayEvents.map((event) => (\r\n                                                            <div\r\n                                                                key={event.id}\r\n                                                                className=\"px-2 py-1 rounded text-xs truncate bg-primary/10 text-primary border border-primary/20\"\r\n                                                            >\r\n                                                                {event.title}\r\n                                                            </div>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </>\r\n                                            )}\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n\r\n                <div className=\"space-y-6\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-lg\">Upcoming Events</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-4\">\r\n                            {isLoading ? (\r\n                                <div className=\"flex justify-center p-4\">\r\n                                    <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\r\n                                </div>\r\n                            ) : events && events.length > 0 ? (\r\n                                events.slice(0, 5).map((event) => (\r\n                                    <div\r\n                                        key={event.id}\r\n                                        className=\"flex items-start gap-4 p-3 rounded-lg border bg-card hover:bg-accent/50 transition-colors\"\r\n                                    >\r\n                                        <div className=\"flex flex-col items-center justify-center w-12 h-12 rounded-lg bg-primary/10 text-primary shrink-0\">\r\n                                            <span className=\"text-xs font-medium uppercase\">\r\n                                                {format(parseISO(event.start_time), \"MMM\")}\r\n                                            </span>\r\n                                            <span className=\"text-lg font-bold\">\r\n                                                {format(parseISO(event.start_time), \"d\")}\r\n                                            </span>\r\n                                        </div>\r\n                                        <div className=\"space-y-1 min-w-0\">\r\n                                            <p className=\"text-sm font-medium leading-none truncate\">\r\n                                                {event.title}\r\n                                            </p>\r\n                                            <p className=\"text-xs text-muted-foreground\">\r\n                                                {format(parseISO(event.start_time), \"h:mm a\")} - {format(parseISO(event.end_time), \"h:mm a\")}\r\n                                            </p>\r\n                                        </div>\r\n                                    </div>\r\n                                ))\r\n                            ) : (\r\n                                <div className=\"text-center py-8 text-muted-foreground text-sm\">\r\n                                    No upcoming events\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    <Card className=\"bg-gradient-to-br from-primary/10 via-primary/5 to-background border-primary/20\">\r\n                        <CardContent className=\"p-6\">\r\n                            <h3 className=\"font-semibold mb-2\">Sync Your Calendar</h3>\r\n                            <p className=\"text-sm text-muted-foreground mb-4\">\r\n                                Connect Google Calendar or Outlook to automatically sync your meetings.\r\n                            </p>\r\n                            <Button className=\"w-full\">Connect Calendar</Button>\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            </div>\r\n\r\n            <EventDialog\r\n                open={isDialogOpen}\r\n                onOpenChange={setIsDialogOpen}\r\n                selectedDate={selectedDate}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\n// Helper for class names\r\nfunction cn(...inputs: (string | undefined | null | false)[]) {\r\n    return inputs.filter(Boolean).join(\" \");\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\calls\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\calls\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\contacts\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\contacts\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\deals\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\deals\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\email\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\email\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\loading.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":2,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[92,103],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Skeleton } from \"@/components/ui/skeleton\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\n\r\nexport default function DashboardLoading() {\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n                <div className=\"space-y-2\">\r\n                    <Skeleton className=\"h-8 w-48\" />\r\n                    <Skeleton className=\"h-4 w-64\" />\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Skeleton className=\"h-10 w-24\" />\r\n                    <Skeleton className=\"h-10 w-24\" />\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n                {[1, 2, 3, 4].map((i) => (\r\n                    <Card key={i}>\r\n                        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                            <Skeleton className=\"h-4 w-24\" />\r\n                            <Skeleton className=\"h-4 w-4 rounded-full\" />\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <Skeleton className=\"h-8 w-16 mb-1\" />\r\n                            <Skeleton className=\"h-3 w-20\" />\r\n                        </CardContent>\r\n                    </Card>\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"grid gap-6 lg:grid-cols-7\">\r\n                <Card className=\"lg:col-span-4\">\r\n                    <CardHeader>\r\n                        <Skeleton className=\"h-5 w-32\" />\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        {[1, 2, 3, 4, 5].map((i) => (\r\n                            <div key={i} className=\"flex items-center gap-4\">\r\n                                <Skeleton className=\"h-10 w-10 rounded-full\" />\r\n                                <div className=\"space-y-2 flex-1\">\r\n                                    <Skeleton className=\"h-4 w-1/3\" />\r\n                                    <Skeleton className=\"h-3 w-1/2\" />\r\n                                </div>\r\n                                <Skeleton className=\"h-3 w-12\" />\r\n                            </div>\r\n                        ))}\r\n                    </CardContent>\r\n                </Card>\r\n                <Card className=\"lg:col-span-3\">\r\n                    <CardHeader>\r\n                        <Skeleton className=\"h-5 w-32\" />\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        {[1, 2, 3, 4, 5].map((i) => (\r\n                            <div key={i} className=\"flex items-center gap-3\">\r\n                                <div className=\"flex-1 space-y-2\">\r\n                                    <Skeleton className=\"h-4 w-3/4\" />\r\n                                    <Skeleton className=\"h-3 w-1/4\" />\r\n                                </div>\r\n                                <Skeleton className=\"h-6 w-12 rounded-full\" />\r\n                            </div>\r\n                        ))}\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\reports\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Legend' is defined but never used.","line":29,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Legend"},"fix":{"range":[670,683],"text":""},"desc":"Remove unused variable \"Legend\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PieChart' is defined but never used.","line":30,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"PieChart"},"fix":{"range":[683,698],"text":""},"desc":"Remove unused variable \"PieChart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pie' is defined but never used.","line":31,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pie"},"fix":{"range":[698,708],"text":""},"desc":"Remove unused variable \"Pie\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Cell' is defined but never used.","line":32,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Cell"},"fix":{"range":[708,719],"text":""},"desc":"Remove unused variable \"Cell\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'COLORS' is assigned a value but never used.","line":35,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useMemo } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport {\r\n    BarChart as BarChartIcon,\r\n    TrendingUp,\r\n    Users,\r\n    Phone,\r\n    DollarSign,\r\n    Calendar,\r\n    Download,\r\n    Loader2,\r\n} from \"lucide-react\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useCallLogs, useDeals, useContacts } from \"@/hooks/use-data\";\r\nimport { formatCurrency } from \"@/lib/utils\";\r\nimport {\r\n    BarChart,\r\n    Bar,\r\n    XAxis,\r\n    YAxis,\r\n    CartesianGrid,\r\n    Tooltip,\r\n    ResponsiveContainer,\r\n    LineChart,\r\n    Line,\r\n    Legend,\r\n    PieChart,\r\n    Pie,\r\n    Cell,\r\n} from \"recharts\";\r\n\r\nconst COLORS = [\"#3b82f6\", \"#10b981\", \"#f59e0b\", \"#ef4444\", \"#8b5cf6\"];\r\n\r\nexport default function ReportsPage() {\r\n    const { data: callLogs, isLoading: callsLoading } = useCallLogs(1000);\r\n    const { data: deals, isLoading: dealsLoading } = useDeals();\r\n    const { data: contacts, isLoading: contactsLoading } = useContacts();\r\n\r\n    const isLoading = callsLoading || dealsLoading || contactsLoading;\r\n\r\n    // Process Call Data\r\n    const callStats = useMemo(() => {\r\n        if (!callLogs) return [];\r\n        const days: Record<string, number> = {};\r\n        // Last 7 days\r\n        for (let i = 6; i >= 0; i--) {\r\n            const d = new Date();\r\n            d.setDate(d.getDate() - i);\r\n            days[d.toISOString().split(\"T\")[0]] = 0;\r\n        }\r\n\r\n        callLogs.forEach((log) => {\r\n            const date = log.started_at.split(\"T\")[0];\r\n            if (days[date] !== undefined) {\r\n                days[date]++;\r\n            }\r\n        });\r\n\r\n        return Object.entries(days).map(([name, total]) => ({ name, total }));\r\n    }, [callLogs]);\r\n\r\n    // Process Deal Data\r\n    const pipelineStats = useMemo(() => {\r\n        if (!deals) return [];\r\n        const stages: Record<string, { name: string; value: number }> = {\r\n            \"lead\": { name: \"Lead\", value: 0 },\r\n            \"qualified\": { name: \"Qualified\", value: 0 },\r\n            \"proposal\": { name: \"Proposal\", value: 0 },\r\n            \"negotiation\": { name: \"Negotiation\", value: 0 },\r\n            \"closed-won\": { name: \"Closed Won\", value: 0 },\r\n        };\r\n\r\n        deals.forEach((deal) => {\r\n            if (stages[deal.stage]) {\r\n                stages[deal.stage].value += deal.value;\r\n            }\r\n        });\r\n\r\n        return Object.values(stages);\r\n    }, [deals]);\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center py-24\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            className=\"space-y-6\"\r\n        >\r\n            <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight\">Analytics & Reports</h1>\r\n                    <p className=\"text-muted-foreground\">\r\n                        Visualize your sales performance and team activity\r\n                    </p>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Button variant=\"outline\">\r\n                        <Calendar className=\"h-4 w-4 mr-2\" />\r\n                        Last 30 Days\r\n                    </Button>\r\n                    <Button>\r\n                        <Download className=\"h-4 w-4 mr-2\" />\r\n                        Export Data\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Top Stats */}\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Total Revenue</CardTitle>\r\n                        <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">{formatCurrency(deals?.filter(d => d.stage === 'closed-won').reduce((a, b) => a + b.value, 0) || 0)}</div>\r\n                        <p className=\"text-xs text-muted-foreground flex items-center gap-1 mt-1\">\r\n                            <TrendingUp className=\"h-3 w-3 text-green-500\" />\r\n                            +12% from last month\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Call Connect Rate</CardTitle>\r\n                        <Phone className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">48.2%</div>\r\n                        <p className=\"text-xs text-muted-foreground mt-1\">Average 5.2 mins per call</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">New Leads</CardTitle>\r\n                        <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">+{contacts?.length || 0}</div>\r\n                        <p className=\"text-xs text-muted-foreground mt-1\">Growth this quarter</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Win Rate</CardTitle>\r\n                        <BarChartIcon className=\"h-4 w-4 text-muted-foreground\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold\">24%</div>\r\n                        <p className=\"text-xs text-muted-foreground mt-1\">Up 2% since last week</p>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n                {/* Call Volume Chart */}\r\n                <Card className=\"p-6\">\r\n                    <CardHeader className=\"px-0 pt-0\">\r\n                        <CardTitle>Call Volume</CardTitle>\r\n                        <CardDescription>Daily outgoing calls over the last 7 days</CardDescription>\r\n                    </CardHeader>\r\n                    <div className=\"h-[300px] w-full\">\r\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                            <LineChart data={callStats}>\r\n                                <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#f0f0f0\" />\r\n                                <XAxis\r\n                                    dataKey=\"name\"\r\n                                    stroke=\"#888888\"\r\n                                    fontSize={12}\r\n                                    tickLine={false}\r\n                                    axisLine={false}\r\n                                    tickFormatter={(str) => new Date(str).toLocaleDateString(\"en-US\", { weekday: 'short' })}\r\n                                />\r\n                                <YAxis\r\n                                    stroke=\"#888888\"\r\n                                    fontSize={12}\r\n                                    tickLine={false}\r\n                                    axisLine={false}\r\n                                />\r\n                                <Tooltip\r\n                                    contentStyle={{ backgroundColor: '#fff', borderRadius: '8px', border: '1px solid #e0e0e0', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' }}\r\n                                />\r\n                                <Line\r\n                                    type=\"monotone\"\r\n                                    dataKey=\"total\"\r\n                                    stroke=\"#3b82f6\"\r\n                                    strokeWidth={3}\r\n                                    dot={{ r: 4, strokeWidth: 2, fill: '#fff' }}\r\n                                    activeDot={{ r: 6, strokeWidth: 0 }}\r\n                                />\r\n                            </LineChart>\r\n                        </ResponsiveContainer>\r\n                    </div>\r\n                </Card>\r\n\r\n                {/* Pipeline Value Chart */}\r\n                <Card className=\"p-6\">\r\n                    <CardHeader className=\"px-0 pt-0\">\r\n                        <CardTitle>Pipeline Distribution</CardTitle>\r\n                        <CardDescription>Value distribution across sales stages</CardDescription>\r\n                    </CardHeader>\r\n                    <div className=\"h-[300px] w-full\">\r\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                            <BarChart data={pipelineStats}>\r\n                                <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#f0f0f0\" />\r\n                                <XAxis\r\n                                    dataKey=\"name\"\r\n                                    stroke=\"#888888\"\r\n                                    fontSize={12}\r\n                                    tickLine={false}\r\n                                    axisLine={false}\r\n                                />\r\n                                <YAxis\r\n                                    stroke=\"#888888\"\r\n                                    fontSize={12}\r\n                                    tickLine={false}\r\n                                    axisLine={false}\r\n                                    tickFormatter={(value) => `$${value / 1000}k`}\r\n                                />\r\n                                <Tooltip\r\n                                    formatter={(value: number) => formatCurrency(value)}\r\n                                    contentStyle={{ backgroundColor: '#fff', borderRadius: '8px', border: '1px solid #e0e0e0' }}\r\n                                />\r\n                                <Bar\r\n                                    dataKey=\"value\"\r\n                                    fill=\"#3b82f6\"\r\n                                    radius={[4, 4, 0, 0]}\r\n                                    barSize={40}\r\n                                />\r\n                            </BarChart>\r\n                        </ResponsiveContainer>\r\n                    </div>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* Performance Table Placeholder */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Team Leaderboard</CardTitle>\r\n                    <CardDescription>Performance based on deals closed and call activity</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"relative w-full overflow-auto\">\r\n                        <table className=\"w-full caption-bottom text-sm\">\r\n                            <thead className=\"[&_tr]:border-b\">\r\n                                <tr className=\"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\">\r\n                                    <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\">Agent</th>\r\n                                    <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\">Calls</th>\r\n                                    <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\">Deals Won</th>\r\n                                    <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\">Revenue</th>\r\n                                    <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\">Conversion</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"[&_tr:last-child]:border-0\">\r\n                                {[\r\n                                    { name: \"Sarah Johnson\", calls: 452, deals: 12, revenue: 145000, conv: \"2.6%\" },\r\n                                    { name: \"Michael Chen\", calls: 384, deals: 8, revenue: 92000, conv: \"2.1%\" },\r\n                                    { name: \"John Smith\", calls: 512, deals: 7, revenue: 84000, conv: \"1.4%\" },\r\n                                ].map((agent) => (\r\n                                    <tr key={agent.name} className=\"border-b transition-colors hover:bg-muted/50\">\r\n                                        <td className=\"p-4 align-middle font-medium\">{agent.name}</td>\r\n                                        <td className=\"p-4 align-middle\">{agent.calls}</td>\r\n                                        <td className=\"p-4 align-middle\">{agent.deals}</td>\r\n                                        <td className=\"p-4 align-middle\">{formatCurrency(agent.revenue)}</td>\r\n                                        <td className=\"p-4 align-middle\">\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <div className=\"w-full h-2 bg-muted rounded-full overflow-hidden max-w-[60px]\">\r\n                                                    <div className=\"h-full bg-primary\" style={{ width: agent.conv }} />\r\n                                                </div>\r\n                                                {agent.conv}\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        </motion.div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\settings\\page.tsx","messages":[{"ruleId":"react-hooks/incompatible-library","severity":1,"message":"Compilation Skipped: Use of incompatible library\n\nThis API returns functions which cannot be memoized without leading to stale UI. To prevent this, by default React Compiler will skip memoizing this component/hook. However, you may see issues if values from this API are passed to other components/hooks that are memoized.\n\nC:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\settings\\page.tsx:314:124\n  312 |                                                 <div className=\"flex gap-2\">\n  313 |                                                     <Input id=\"primary_color\" {...orgForm.register(\"primary_color\")} />\n> 314 |                                                     <div className=\"w-10 h-10 rounded-md border\" style={{ backgroundColor: orgForm.watch(\"primary_color\") }} />\n      |                                                                                                                            ^^^^^^^ React Hook Form's `useForm()` API returns a `watch()` function which cannot be memoized safely.\n  315 |                                                 </div>\n  316 |                                             </div>\n  317 |                                             <div className=\"space-y-2\">","line":314,"column":124,"nodeType":null,"endLine":314,"endColumn":131}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { motion } from \"framer-motion\";\r\nimport {\r\n    User,\r\n    Building2,\r\n    Palette,\r\n    Mail,\r\n    Phone,\r\n    Shield,\r\n    Bell,\r\n    Database,\r\n    Key,\r\n} from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\n\r\nimport { useActiveProfile, useUpdateProfile, useOrganization, useUpdateOrganization, useSipProfile, useUpdateSipProfile, useSmtpConfig, useUpdateSmtpConfig, useApiKeys, useUpdateApiKeys } from \"@/hooks/use-data\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Loader2 } from \"lucide-react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { toast } from \"sonner\";\r\nimport { useEffect } from \"react\";\r\nimport type { Profile, Organization, SIPProfile, SMTPConfig, APIKeys, AIProvider } from \"@/types\";\r\n\r\nexport default function SettingsPage() {\r\n    const { data: profile, isLoading: profileLoading } = useActiveProfile();\r\n    const { data: org, isLoading: orgLoading } = useOrganization(profile?.organization_id || null);\r\n    const { data: sip, isLoading: sipLoading } = useSipProfile(profile?.id || null);\r\n    const { data: smtp, isLoading: smtpLoading } = useSmtpConfig(profile?.organization_id || null);\r\n    const { data: apiKeys, isLoading: apiKeysLoading } = useApiKeys(profile?.organization_id || null);\r\n\r\n    const { trigger: updateProfile, isMutating: isUpdatingProfile } = useUpdateProfile();\r\n    const { trigger: updateOrg, isMutating: isUpdatingOrg } = useUpdateOrganization();\r\n    const { trigger: updateSip, isMutating: isUpdatingSip } = useUpdateSipProfile();\r\n    const { trigger: updateSmtp, isMutating: isUpdatingSmtp } = useUpdateSmtpConfig();\r\n    const { trigger: updateApiKeys, isMutating: isUpdatingApiKeys } = useUpdateApiKeys();\r\n\r\n    const router = useRouter();\r\n    const isAdmin = profile?.role === \"admin\" || profile?.role === \"manager\";\r\n\r\n    // Profile Form\r\n    const profileForm = useForm({\r\n        defaultValues: {\r\n            full_name: profile?.full_name || \"\",\r\n            phone: profile?.phone || \"\",\r\n        }\r\n    });\r\n\r\n    // Organization Form\r\n    const orgForm = useForm({\r\n        defaultValues: {\r\n            name: org?.name || \"\",\r\n            slug: org?.slug || \"\",\r\n            primary_color: org?.primary_color || \"#3b82f6\",\r\n            logo_url: org?.logo_url || \"\",\r\n        }\r\n    });\r\n\r\n    // SIP Form\r\n    const sipForm = useForm({\r\n        defaultValues: {\r\n            display_name: sip?.display_name || \"\",\r\n            sip_username: sip?.sip_username || \"\",\r\n            sip_password: \"\", // Handled separately/hidden\r\n            sip_domain: sip?.sip_domain || \"\",\r\n            outbound_proxy: sip?.outbound_proxy || \"\",\r\n            ws_server: sip?.ws_server || \"\",\r\n        }\r\n    });\r\n\r\n    // SMTP Form\r\n    const smtpForm = useForm({\r\n        defaultValues: {\r\n            host: smtp?.host || \"\",\r\n            port: smtp?.port || 587,\r\n            username: smtp?.username || \"\",\r\n            password: \"\",\r\n            from_name: smtp?.from_name || \"\",\r\n            from_email: smtp?.from_email || \"\",\r\n        }\r\n    });\r\n\r\n    // API Keys Form\r\n    const apiKeysForm = useForm({\r\n        defaultValues: {\r\n            openai_key: \"\",\r\n            gemini_key: \"\",\r\n            qwen_key: \"\",\r\n            kimi_key: \"\",\r\n            active_provider: (apiKeys?.active_provider || \"openai\") as AIProvider,\r\n        }\r\n    });\r\n\r\n    // Sync forms when data loads\r\n    useEffect(() => {\r\n        if (profile) profileForm.reset({ full_name: profile.full_name, phone: profile.phone });\r\n    }, [profile, profileForm]);\r\n\r\n    useEffect(() => {\r\n        if (org) orgForm.reset({ name: org.name, slug: org.slug, primary_color: org.primary_color, logo_url: org.logo_url });\r\n    }, [org, orgForm]);\r\n\r\n    useEffect(() => {\r\n        if (sip) sipForm.reset({\r\n            display_name: sip.display_name,\r\n            sip_username: sip.sip_username,\r\n            sip_domain: sip.sip_domain,\r\n            outbound_proxy: sip.outbound_proxy || \"\"\r\n        });\r\n    }, [sip, sipForm]);\r\n\r\n    useEffect(() => {\r\n        if (smtp) smtpForm.reset({\r\n            host: smtp.host,\r\n            port: smtp.port,\r\n            username: smtp.username,\r\n            from_name: smtp.from_name || \"\",\r\n            from_email: smtp.from_email || \"\"\r\n        });\r\n    }, [smtp, smtpForm]);\r\n\r\n    useEffect(() => {\r\n        if (apiKeys) apiKeysForm.reset({\r\n            active_provider: apiKeys.active_provider || \"openai\",\r\n            // Note: We don't populate the keys since they're encrypted; user must re-enter to update\r\n        });\r\n    }, [apiKeys, apiKeysForm]);\r\n\r\n\r\n    if (profileLoading || orgLoading || sipLoading || smtpLoading || apiKeysLoading) {\r\n        return (\r\n            <div className=\"flex h-[400px] items-center justify-center\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n\r\n    if (!profile) {\r\n        return (\r\n            <div className=\"flex flex-col items-center justify-center h-[400px] space-y-4\">\r\n                <p className=\"text-muted-foreground\">Profile not found. Please log in again.</p>\r\n                <Button onClick={() => router.push(\"/login\")}>Go to Login</Button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const onProfileSubmit = async (data: Partial<Profile>) => {\r\n        try {\r\n            await updateProfile({ id: profile.id, updates: data });\r\n            toast.success(\"Profile updated successfully\");\r\n        } catch {\r\n            toast.error(\"Failed to update profile\");\r\n        }\r\n    };\r\n\r\n    const onOrgSubmit = async (data: Partial<Organization>) => {\r\n        try {\r\n            await updateOrg({ id: org?.id || \"\", updates: data });\r\n            toast.success(\"Organization updated successfully\");\r\n        } catch {\r\n            toast.error(\"Failed to update organization\");\r\n        }\r\n    };\r\n\r\n    const onSipSubmit = async (data: Partial<SIPProfile>) => {\r\n        try {\r\n            await updateSip({ userId: profile.id, orgId: profile.organization_id, updates: data });\r\n            toast.success(\"SIP settings updated successfully\");\r\n        } catch {\r\n            toast.error(\"Failed to update SIP settings\");\r\n        }\r\n    };\r\n\r\n    const onSmtpSubmit = async (data: Partial<SMTPConfig>) => {\r\n        try {\r\n            await updateSmtp({ orgId: profile.organization_id, updates: data });\r\n            toast.success(\"SMTP settings updated successfully\");\r\n        } catch {\r\n            toast.error(\"Failed to update SMTP settings\");\r\n        }\r\n    };\r\n\r\n    const onApiKeysSubmit = async (data: { openai_key: string; gemini_key: string; qwen_key: string; kimi_key: string; active_provider: AIProvider }) => {\r\n        try {\r\n            const updates: Partial<APIKeys> = {\r\n                active_provider: data.active_provider,\r\n            };\r\n            // Only include keys that were entered (non-empty)\r\n            if (data.openai_key) updates.openai_key_encrypted = data.openai_key;\r\n            if (data.gemini_key) updates.gemini_key_encrypted = data.gemini_key;\r\n            if (data.qwen_key) updates.qwen_key_encrypted = data.qwen_key;\r\n            if (data.kimi_key) updates.kimi_key_encrypted = data.kimi_key;\r\n\r\n            await updateApiKeys({ orgId: profile.organization_id, updates });\r\n            toast.success(\"API keys saved successfully\");\r\n            apiKeysForm.reset({ openai_key: \"\", gemini_key: \"\", qwen_key: \"\", kimi_key: \"\", active_provider: data.active_provider });\r\n        } catch {\r\n            toast.error(\"Failed to save API keys\");\r\n        }\r\n    };\r\n\r\n\r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            className=\"space-y-6\"\r\n        >\r\n            {/* Header */}\r\n            <div>\r\n                <h1 className=\"text-3xl font-bold tracking-tight\">Settings</h1>\r\n                <p className=\"text-muted-foreground\">\r\n                    Manage your account and organization settings\r\n                </p>\r\n            </div>\r\n\r\n            <Tabs defaultValue=\"profile\" className=\"space-y-6\">\r\n                <TabsList className=\"grid w-full grid-cols-2 lg:grid-cols-5\">\r\n                    <TabsTrigger value=\"profile\">Profile</TabsTrigger>\r\n                    {isAdmin && <TabsTrigger value=\"organization\">Organization</TabsTrigger>}\r\n                    <TabsTrigger value=\"integrations\">Integrations</TabsTrigger>\r\n                    <TabsTrigger value=\"notifications\">Notifications</TabsTrigger>\r\n                    <TabsTrigger value=\"security\">Security</TabsTrigger>\r\n                </TabsList>\r\n\r\n                {/* Profile Settings */}\r\n                <TabsContent value=\"profile\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"flex items-center gap-2\">\r\n                                <User className=\"h-5 w-5\" />\r\n                                Profile Settings\r\n                            </CardTitle>\r\n                            <CardDescription>\r\n                                Manage your personal information and preferences\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-6\">\r\n                            <form onSubmit={profileForm.handleSubmit(onProfileSubmit)} className=\"space-y-6\">\r\n                                <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                                    <div className=\"space-y-2\">\r\n                                        <Label htmlFor=\"full_name\">Full Name</Label>\r\n                                        <Input id=\"full_name\" {...profileForm.register(\"full_name\")} />\r\n                                    </div>\r\n                                    <div className=\"space-y-2\">\r\n                                        <Label htmlFor=\"email\">Email</Label>\r\n                                        <Input id=\"email\" type=\"email\" value={profile.email} disabled />\r\n                                        <p className=\"text-xs text-muted-foreground\">Email cannot be changed.</p>\r\n                                    </div>\r\n                                    <div className=\"space-y-2\">\r\n                                        <Label htmlFor=\"phone\">Phone</Label>\r\n                                        <Input id=\"phone\" type=\"tel\" {...profileForm.register(\"phone\")} />\r\n                                    </div>\r\n                                </div>\r\n                                <Button type=\"submit\" disabled={isUpdatingProfile}>\r\n                                    {isUpdatingProfile && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                                    Save Changes\r\n                                </Button>\r\n                            </form>\r\n                        </CardContent>\r\n                    </Card>\r\n                </TabsContent>\r\n\r\n                {/* Organization Settings - Admin Only */}\r\n                {isAdmin && (\r\n                    <TabsContent value=\"organization\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Building2 className=\"h-5 w-5\" />\r\n                                    Organization Settings\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Configure your organization&apos;s branding and preferences\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-6\">\r\n                                <form onSubmit={orgForm.handleSubmit(onOrgSubmit)} className=\"space-y-6\">\r\n                                    <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"name\">Organization Name</Label>\r\n                                            <Input id=\"name\" {...orgForm.register(\"name\")} />\r\n                                        </div>\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"slug\">Subdomain</Label>\r\n                                            <div className=\"flex\">\r\n                                                <Input id=\"slug\" {...orgForm.register(\"slug\")} className=\"rounded-r-none\" />\r\n                                                <span className=\"flex items-center px-3 bg-muted border border-l-0 rounded-r-md text-sm text-muted-foreground\">\r\n                                                    .nanosol.app\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <Separator />\r\n\r\n                                    <div>\r\n                                        <h4 className=\"font-medium mb-4 flex items-center gap-2\">\r\n                                            <Palette className=\"h-4 w-4\" />\r\n                                            Branding\r\n                                        </h4>\r\n                                        <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                                            <div className=\"space-y-2\">\r\n                                                <Label htmlFor=\"primary_color\">Primary Color</Label>\r\n                                                <div className=\"flex gap-2\">\r\n                                                    <Input id=\"primary_color\" {...orgForm.register(\"primary_color\")} />\r\n                                                    <div className=\"w-10 h-10 rounded-md border\" style={{ backgroundColor: orgForm.watch(\"primary_color\") }} />\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"space-y-2\">\r\n                                                <Label htmlFor=\"logo_url\">Logo URL</Label>\r\n                                                <Input id=\"logo_url\" {...orgForm.register(\"logo_url\")} placeholder=\"https://...\" />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <Button type=\"submit\" disabled={isUpdatingOrg}>\r\n                                        {isUpdatingOrg && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                                        Save Organization\r\n                                    </Button>\r\n                                </form>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </TabsContent>\r\n                )}\r\n\r\n                {/* Integrations */}\r\n                <TabsContent value=\"integrations\">\r\n                    <div className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Phone className=\"h-5 w-5\" />\r\n                                    SIP Configuration\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Configure your SIP credentials for making calls\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <form onSubmit={sipForm.handleSubmit(onSipSubmit)} className=\"space-y-4\">\r\n                                    <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"display_name\">Display Name</Label>\r\n                                            <Input id=\"display_name\" {...sipForm.register(\"display_name\")} />\r\n                                        </div>\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"sip_username\">SIP Username</Label>\r\n                                            <Input id=\"sip_username\" {...sipForm.register(\"sip_username\")} />\r\n                                        </div>\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"sip_password\">SIP Password</Label>\r\n                                            <Input id=\"sip_password\" type=\"password\" {...sipForm.register(\"sip_password\")} placeholder=\"\" />\r\n                                        </div>\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"sip_domain\">SIP Domain</Label>\r\n                                            <Input id=\"sip_domain\" {...sipForm.register(\"sip_domain\")} placeholder=\"sip.provider.com\" />\r\n                                        </div>\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"ws_server\">WebSocket Server URL</Label>\r\n                                            <Input id=\"ws_server\" {...sipForm.register(\"ws_server\")} placeholder=\"wss://sip.provider.com:8089/ws\" />\r\n                                        </div>\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"outbound_proxy\">Outbound Proxy (optional)</Label>\r\n                                            <Input id=\"outbound_proxy\" {...sipForm.register(\"outbound_proxy\")} />\r\n                                        </div>\r\n                                    </div>\r\n                                    <Button type=\"submit\" disabled={isUpdatingSip}>\r\n                                        {isUpdatingSip && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                                        Save SIP Settings\r\n                                    </Button>\r\n                                </form>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {isAdmin && (\r\n                            <>\r\n                                <Card>\r\n                                    <CardHeader>\r\n                                        <CardTitle className=\"flex items-center gap-2\">\r\n                                            <Mail className=\"h-5 w-5\" />\r\n                                            SMTP Configuration\r\n                                        </CardTitle>\r\n                                        <CardDescription>\r\n                                            Configure your email sending settings\r\n                                        </CardDescription>\r\n                                    </CardHeader>\r\n                                    <CardContent className=\"space-y-4\">\r\n                                        <form onSubmit={smtpForm.handleSubmit(onSmtpSubmit)} className=\"space-y-4\">\r\n                                            <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"host\">SMTP Host</Label>\r\n                                                    <Input id=\"host\" {...smtpForm.register(\"host\")} placeholder=\"smtp.provider.com\" />\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"port\">SMTP Port</Label>\r\n                                                    <Input id=\"port\" {...smtpForm.register(\"port\", { valueAsNumber: true })} placeholder=\"587\" />\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"username\">Username</Label>\r\n                                                    <Input id=\"username\" {...smtpForm.register(\"username\")} placeholder=\"your-email@domain.com\" />\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"password\">Password</Label>\r\n                                                    <Input id=\"password\" type=\"password\" {...smtpForm.register(\"password\")} placeholder=\"\" />\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"from_name\">From Name</Label>\r\n                                                    <Input id=\"from_name\" {...smtpForm.register(\"from_name\")} placeholder=\"Your Name\" />\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"from_email\">From Email</Label>\r\n                                                    <Input id=\"from_email\" {...smtpForm.register(\"from_email\")} placeholder=\"no-reply@domain.com\" />\r\n                                                </div>\r\n                                            </div>\r\n                                            <Button type=\"submit\" disabled={isUpdatingSmtp}>\r\n                                                {isUpdatingSmtp && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                                                Save SMTP Settings\r\n                                            </Button>\r\n                                        </form>\r\n                                    </CardContent>\r\n                                </Card>\r\n\r\n                                <Card>\r\n                                    <CardHeader>\r\n                                        <CardTitle className=\"flex items-center gap-2\">\r\n                                            <Key className=\"h-5 w-5\" />\r\n                                            API Keys\r\n                                        </CardTitle>\r\n                                        <CardDescription>\r\n                                            Manage your API keys for AI-powered features. Keys are securely stored.\r\n                                        </CardDescription>\r\n                                    </CardHeader>\r\n                                    <CardContent className=\"space-y-4\">\r\n                                        <form onSubmit={apiKeysForm.handleSubmit(onApiKeysSubmit)} className=\"space-y-4\">\r\n                                            <div className=\"space-y-2\">\r\n                                                <Label htmlFor=\"active_provider\">Active AI Provider</Label>\r\n                                                <select\r\n                                                    id=\"active_provider\"\r\n                                                    {...apiKeysForm.register(\"active_provider\")}\r\n                                                    className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\r\n                                                >\r\n                                                    <option value=\"openai\">OpenAI (GPT-4)</option>\r\n                                                    <option value=\"gemini\">Google Gemini</option>\r\n                                                    <option value=\"qwen\">Alibaba QWEN</option>\r\n                                                    <option value=\"kimi\">Moonshot KIMI</option>\r\n                                                </select>\r\n                                            </div>\r\n                                            <Separator />\r\n                                            <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"openai_key\">OpenAI API Key</Label>\r\n                                                    <Input id=\"openai_key\" type=\"password\" {...apiKeysForm.register(\"openai_key\")} placeholder=\"sk-...\" />\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"gemini_key\">Gemini API Key</Label>\r\n                                                    <Input id=\"gemini_key\" type=\"password\" {...apiKeysForm.register(\"gemini_key\")} placeholder=\"AIza...\" />\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"qwen_key\">QWEN API Key</Label>\r\n                                                    <Input id=\"qwen_key\" type=\"password\" {...apiKeysForm.register(\"qwen_key\")} placeholder=\"qwen-...\" />\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"kimi_key\">KIMI API Key</Label>\r\n                                                    <Input id=\"kimi_key\" type=\"password\" {...apiKeysForm.register(\"kimi_key\")} placeholder=\"kimi-...\" />\r\n                                                </div>\r\n                                            </div>\r\n                                            <p className=\"text-xs text-muted-foreground\">\r\n                                                Only enter keys you wish to update. Leave fields empty to keep existing keys.\r\n                                            </p>\r\n                                            <Button type=\"submit\" disabled={isUpdatingApiKeys}>\r\n                                                {isUpdatingApiKeys && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                                                Save API Keys\r\n                                            </Button>\r\n                                        </form>\r\n                                    </CardContent>\r\n                                </Card>\r\n\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                </TabsContent>\r\n\r\n                {/* Notifications */}\r\n                <TabsContent value=\"notifications\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"flex items-center gap-2\">\r\n                                <Bell className=\"h-5 w-5\" />\r\n                                Notification Preferences\r\n                            </CardTitle>\r\n                            <CardDescription>\r\n                                Choose what notifications you want to receive\r\n                            </CardDescription>\r\n                        </CardHeader>\r\n                        <CardContent className=\"space-y-6\">\r\n                            <div className=\"space-y-4\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div>\r\n                                        <p className=\"font-medium\">Email Notifications</p>\r\n                                        <p className=\"text-sm text-muted-foreground\">\r\n                                            Receive email updates for important events\r\n                                        </p>\r\n                                    </div>\r\n                                    <Switch defaultChecked />\r\n                                </div>\r\n                                <Separator />\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div>\r\n                                        <p className=\"font-medium\">New Lead Alerts</p>\r\n                                        <p className=\"text-sm text-muted-foreground\">\r\n                                            Get notified when new leads are created\r\n                                        </p>\r\n                                    </div>\r\n                                    <Switch defaultChecked />\r\n                                </div>\r\n                                <Separator />\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div>\r\n                                        <p className=\"font-medium\">Deal Updates</p>\r\n                                        <p className=\"text-sm text-muted-foreground\">\r\n                                            Notifications for deal stage changes\r\n                                        </p>\r\n                                    </div>\r\n                                    <Switch defaultChecked />\r\n                                </div>\r\n                                <Separator />\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div>\r\n                                        <p className=\"font-medium\">Task Reminders</p>\r\n                                        <p className=\"text-sm text-muted-foreground\">\r\n                                            Reminders for upcoming and overdue tasks\r\n                                        </p>\r\n                                    </div>\r\n                                    <Switch defaultChecked />\r\n                                </div>\r\n                                <Separator />\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div>\r\n                                        <p className=\"font-medium\">Missed Call Alerts</p>\r\n                                        <p className=\"text-sm text-muted-foreground\">\r\n                                            Get notified about missed incoming calls\r\n                                        </p>\r\n                                    </div>\r\n                                    <Switch />\r\n                                </div>\r\n                            </div>\r\n                            <Button onClick={() => toast.success(\"Notification preferences saved\")}>\r\n                                Save Preferences\r\n                            </Button>\r\n                        </CardContent>\r\n                    </Card>\r\n                </TabsContent>\r\n\r\n                {/* Security */}\r\n                <TabsContent value=\"security\">\r\n                    <div className=\"space-y-6\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Shield className=\"h-5 w-5\" />\r\n                                    Security Settings\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Manage your account security\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-6\">\r\n                                <div className=\"space-y-4\">\r\n                                    <div className=\"space-y-2\">\r\n                                        <Label htmlFor=\"currentPass\">Current Password</Label>\r\n                                        <Input id=\"currentPass\" type=\"password\" />\r\n                                    </div>\r\n                                    <div className=\"space-y-2\">\r\n                                        <Label htmlFor=\"newPass\">New Password</Label>\r\n                                        <Input id=\"newPass\" type=\"password\" />\r\n                                    </div>\r\n                                    <div className=\"space-y-2\">\r\n                                        <Label htmlFor=\"confirmPass\">Confirm New Password</Label>\r\n                                        <Input id=\"confirmPass\" type=\"password\" />\r\n                                    </div>\r\n                                </div>\r\n                                <Button onClick={() => toast.success(\"Password update feature coming soon\")}>\r\n                                    Update Password\r\n                                </Button>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle className=\"flex items-center gap-2\">\r\n                                    <Database className=\"h-5 w-5\" />\r\n                                    Data Management\r\n                                </CardTitle>\r\n                                <CardDescription>\r\n                                    Export or delete your data\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent className=\"space-y-4\">\r\n                                <div className=\"flex items-center justify-between p-4 rounded-lg border\">\r\n                                    <div>\r\n                                        <p className=\"font-medium\">Export All Data</p>\r\n                                        <p className=\"text-sm text-muted-foreground\">\r\n                                            Download all your CRM data as JSON/CSV\r\n                                        </p>\r\n                                    </div>\r\n                                    <Button variant=\"outline\">Export</Button>\r\n                                </div>\r\n                                <div className=\"flex items-center justify-between p-4 rounded-lg border border-destructive/50\">\r\n                                    <div>\r\n                                        <p className=\"font-medium text-destructive\">Delete Account</p>\r\n                                        <p className=\"text-sm text-muted-foreground\">\r\n                                            Permanently delete your account and all data\r\n                                        </p>\r\n                                    </div>\r\n                                    <Button variant=\"destructive\">Delete</Button>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </div>\r\n                </TabsContent>\r\n            </Tabs>\r\n        </motion.div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\dashboard\\team\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":43,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Sparkles, Mail, Lock, ArrowRight, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\nimport { toast } from \"sonner\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\n\r\nexport default function LoginPage() {\r\n    const router = useRouter();\r\n    const supabase = createClient();\r\n    const [email, setEmail] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setIsLoading(true);\r\n\r\n        try {\r\n            const { data, error } = await supabase.auth.signInWithPassword({\r\n                email,\r\n                password,\r\n            });\r\n\r\n            if (error) {\r\n                toast.error(error.message);\r\n                return;\r\n            }\r\n\r\n            if (data.user) {\r\n                toast.success(\"Welcome back!\");\r\n                router.push(\"/dashboard\");\r\n                router.refresh();\r\n            }\r\n        } catch (error) {\r\n            toast.error(\"An unexpected error occurred\");\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleGoogleLogin = async () => {\r\n        const { error } = await supabase.auth.signInWithOAuth({\r\n            provider: \"google\",\r\n            options: {\r\n                redirectTo: `${window.location.origin}/auth/callback`,\r\n            },\r\n        });\r\n        if (error) {\r\n            toast.error(error.message);\r\n        }\r\n    };\r\n\r\n    const handleGitHubLogin = async () => {\r\n        const { error } = await supabase.auth.signInWithOAuth({\r\n            provider: \"github\",\r\n            options: {\r\n                redirectTo: `${window.location.origin}/auth/callback`,\r\n            },\r\n        });\r\n        if (error) {\r\n            toast.error(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-background to-primary/5 p-4\">\r\n            <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ duration: 0.5 }}\r\n                className=\"w-full max-w-md\"\r\n            >\r\n                {/* Logo */}\r\n                <div className=\"flex items-center justify-center gap-2 mb-8\">\r\n                    <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-primary\">\r\n                        <Sparkles className=\"h-6 w-6 text-primary-foreground\" />\r\n                    </div>\r\n                    <span className=\"text-2xl font-bold\">NanoSol CRM</span>\r\n                </div>\r\n\r\n                <Card>\r\n                    <CardHeader className=\"text-center\">\r\n                        <CardTitle>Welcome back</CardTitle>\r\n                        <CardDescription>\r\n                            Sign in to your account to continue\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor=\"email\">Email</Label>\r\n                                <div className=\"relative\">\r\n                                    <Mail className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                                    <Input\r\n                                        id=\"email\"\r\n                                        type=\"email\"\r\n                                        placeholder=\"you@company.com\"\r\n                                        value={email}\r\n                                        onChange={(e) => setEmail(e.target.value)}\r\n                                        className=\"pl-10\"\r\n                                        required\r\n                                        autoComplete=\"email\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <Label htmlFor=\"password\">Password</Label>\r\n                                    <Link\r\n                                        href=\"/forgot-password\"\r\n                                        className=\"text-sm text-primary hover:underline\"\r\n                                    >\r\n                                        Forgot password?\r\n                                    </Link>\r\n                                </div>\r\n                                <div className=\"relative\">\r\n                                    <Lock className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                                    <Input\r\n                                        id=\"password\"\r\n                                        type=\"password\"\r\n                                        placeholder=\"\"\r\n                                        value={password}\r\n                                        onChange={(e) => setPassword(e.target.value)}\r\n                                        className=\"pl-10\"\r\n                                        required\r\n                                        autoComplete=\"current-password\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n                                {isLoading ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Signing in...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        Sign in\r\n                                        <ArrowRight className=\"ml-2 h-4 w-4\" />\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n                        </form>\r\n\r\n                        <div className=\"relative my-6\">\r\n                            <Separator />\r\n                            <span className=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-card px-2 text-xs text-muted-foreground\">\r\n                                or continue with\r\n                            </span>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <Button variant=\"outline\" type=\"button\" onClick={handleGoogleLogin}>\r\n                                <svg className=\"h-4 w-4 mr-2\" viewBox=\"0 0 24 24\">\r\n                                    <path\r\n                                        fill=\"currentColor\"\r\n                                        d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\r\n                                    />\r\n                                    <path\r\n                                        fill=\"currentColor\"\r\n                                        d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\r\n                                    />\r\n                                    <path\r\n                                        fill=\"currentColor\"\r\n                                        d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\r\n                                    />\r\n                                    <path\r\n                                        fill=\"currentColor\"\r\n                                        d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\r\n                                    />\r\n                                </svg>\r\n                                Google\r\n                            </Button>\r\n                            <Button variant=\"outline\" type=\"button\" onClick={handleGitHubLogin}>\r\n                                <svg className=\"h-4 w-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\" />\r\n                                </svg>\r\n                                GitHub\r\n                            </Button>\r\n                        </div>\r\n\r\n                        <p className=\"mt-6 text-center text-sm text-muted-foreground\">\r\n                            Don&apos;t have an account?{\" \"}\r\n                            <Link href=\"/signup\" className=\"text-primary hover:underline\">\r\n                                Sign up\r\n                            </Link>\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\app\\signup\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":65,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":65,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Sparkles, Mail, Lock, User, ArrowRight, Building2, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\nimport { toast } from \"sonner\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\n\r\nexport default function SignupPage() {\r\n    const router = useRouter();\r\n    const supabase = createClient();\r\n    const [formData, setFormData] = useState({\r\n        fullName: \"\",\r\n        email: \"\",\r\n        company: \"\",\r\n        password: \"\",\r\n    });\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setIsLoading(true);\r\n\r\n        try {\r\n            // Sign up the user\r\n            const { data, error } = await supabase.auth.signUp({\r\n                email: formData.email,\r\n                password: formData.password,\r\n                options: {\r\n                    data: {\r\n                        full_name: formData.fullName,\r\n                        company: formData.company,\r\n                    },\r\n                    emailRedirectTo: `${window.location.origin}/auth/callback`,\r\n                },\r\n            });\r\n\r\n            if (error) {\r\n                toast.error(error.message);\r\n                return;\r\n            }\r\n\r\n            if (data.user) {\r\n                // Check if email confirmation is required\r\n                if (data.user.identities?.length === 0) {\r\n                    toast.error(\"An account with this email already exists\");\r\n                } else if (data.session) {\r\n                    // User is signed in immediately (email confirmation disabled)\r\n                    toast.success(\"Account created successfully!\");\r\n                    router.push(\"/dashboard\");\r\n                    router.refresh();\r\n                } else {\r\n                    // Email confirmation required\r\n                    toast.success(\"Check your email to confirm your account\");\r\n                    router.push(\"/login\");\r\n                }\r\n            }\r\n        } catch (error) {\r\n            toast.error(\"An unexpected error occurred\");\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleGoogleSignup = async () => {\r\n        const { error } = await supabase.auth.signInWithOAuth({\r\n            provider: \"google\",\r\n            options: {\r\n                redirectTo: `${window.location.origin}/auth/callback`,\r\n            },\r\n        });\r\n        if (error) {\r\n            toast.error(error.message);\r\n        }\r\n    };\r\n\r\n    const handleGitHubSignup = async () => {\r\n        const { error } = await supabase.auth.signInWithOAuth({\r\n            provider: \"github\",\r\n            options: {\r\n                redirectTo: `${window.location.origin}/auth/callback`,\r\n            },\r\n        });\r\n        if (error) {\r\n            toast.error(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-background to-primary/5 p-4\">\r\n            <motion.div\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ duration: 0.5 }}\r\n                className=\"w-full max-w-md\"\r\n            >\r\n                {/* Logo */}\r\n                <div className=\"flex items-center justify-center gap-2 mb-8\">\r\n                    <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-primary\">\r\n                        <Sparkles className=\"h-6 w-6 text-primary-foreground\" />\r\n                    </div>\r\n                    <span className=\"text-2xl font-bold\">NanoSol CRM</span>\r\n                </div>\r\n\r\n                <Card>\r\n                    <CardHeader className=\"text-center\">\r\n                        <CardTitle>Create your account</CardTitle>\r\n                        <CardDescription>\r\n                            Start your 14-day free trial. No credit card required.\r\n                        </CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor=\"fullName\">Full Name</Label>\r\n                                <div className=\"relative\">\r\n                                    <User className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                                    <Input\r\n                                        id=\"fullName\"\r\n                                        type=\"text\"\r\n                                        placeholder=\"John Smith\"\r\n                                        value={formData.fullName}\r\n                                        onChange={(e) =>\r\n                                            setFormData({ ...formData, fullName: e.target.value })\r\n                                        }\r\n                                        className=\"pl-10\"\r\n                                        required\r\n                                        autoComplete=\"name\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor=\"email\">Work Email</Label>\r\n                                <div className=\"relative\">\r\n                                    <Mail className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                                    <Input\r\n                                        id=\"email\"\r\n                                        type=\"email\"\r\n                                        placeholder=\"you@company.com\"\r\n                                        value={formData.email}\r\n                                        onChange={(e) =>\r\n                                            setFormData({ ...formData, email: e.target.value })\r\n                                        }\r\n                                        className=\"pl-10\"\r\n                                        required\r\n                                        autoComplete=\"email\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor=\"company\">Company Name</Label>\r\n                                <div className=\"relative\">\r\n                                    <Building2 className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                                    <Input\r\n                                        id=\"company\"\r\n                                        type=\"text\"\r\n                                        placeholder=\"Acme Inc\"\r\n                                        value={formData.company}\r\n                                        onChange={(e) =>\r\n                                            setFormData({ ...formData, company: e.target.value })\r\n                                        }\r\n                                        className=\"pl-10\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <Label htmlFor=\"password\">Password</Label>\r\n                                <div className=\"relative\">\r\n                                    <Lock className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                                    <Input\r\n                                        id=\"password\"\r\n                                        type=\"password\"\r\n                                        placeholder=\"\"\r\n                                        value={formData.password}\r\n                                        onChange={(e) =>\r\n                                            setFormData({ ...formData, password: e.target.value })\r\n                                        }\r\n                                        className=\"pl-10\"\r\n                                        required\r\n                                        minLength={8}\r\n                                        autoComplete=\"new-password\"\r\n                                    />\r\n                                </div>\r\n                                <p className=\"text-xs text-muted-foreground\">\r\n                                    Must be at least 8 characters\r\n                                </p>\r\n                            </div>\r\n\r\n                            <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n                                {isLoading ? (\r\n                                    <>\r\n                                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                        Creating account...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        Get started free\r\n                                        <ArrowRight className=\"ml-2 h-4 w-4\" />\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n\r\n                            <p className=\"text-xs text-center text-muted-foreground\">\r\n                                By signing up, you agree to our{\" \"}\r\n                                <Link href=\"/terms\" className=\"underline\">\r\n                                    Terms of Service\r\n                                </Link>{\" \"}\r\n                                and{\" \"}\r\n                                <Link href=\"/privacy\" className=\"underline\">\r\n                                    Privacy Policy\r\n                                </Link>\r\n                            </p>\r\n                        </form>\r\n\r\n                        <div className=\"relative my-6\">\r\n                            <Separator />\r\n                            <span className=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-card px-2 text-xs text-muted-foreground\">\r\n                                or continue with\r\n                            </span>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <Button variant=\"outline\" type=\"button\" onClick={handleGoogleSignup}>\r\n                                <svg className=\"h-4 w-4 mr-2\" viewBox=\"0 0 24 24\">\r\n                                    <path\r\n                                        fill=\"currentColor\"\r\n                                        d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\r\n                                    />\r\n                                    <path\r\n                                        fill=\"currentColor\"\r\n                                        d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\r\n                                    />\r\n                                    <path\r\n                                        fill=\"currentColor\"\r\n                                        d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\r\n                                    />\r\n                                    <path\r\n                                        fill=\"currentColor\"\r\n                                        d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\r\n                                    />\r\n                                </svg>\r\n                                Google\r\n                            </Button>\r\n                            <Button variant=\"outline\" type=\"button\" onClick={handleGitHubSignup}>\r\n                                <svg className=\"h-4 w-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\" />\r\n                                </svg>\r\n                                GitHub\r\n                            </Button>\r\n                        </div>\r\n\r\n                        <p className=\"mt-6 text-center text-sm text-muted-foreground\">\r\n                            Already have an account?{\" \"}\r\n                            <Link href=\"/login\" className=\"text-primary hover:underline\">\r\n                                Sign in\r\n                            </Link>\r\n                        </p>\r\n                    </CardContent>\r\n                </Card>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\automations\\automation-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2598,2601],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2598,2601],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport { z } from \"zod\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n    Form,\r\n    FormControl,\r\n    FormField,\r\n    FormItem,\r\n    FormLabel,\r\n    FormMessage,\r\n} from \"@/components/ui/form\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { useCreateAutomationRule, useUpdateAutomationRule } from \"@/hooks/use-data\";\r\nimport { toast } from \"sonner\";\r\nimport type { AutomationRule } from \"@/types\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\nconst TRIGGER_TYPES = [\r\n    { value: \"lead_created\", label: \"Lead Created\" },\r\n    { value: \"deal_stage_changed\", label: \"Deal Stage Changed\" },\r\n    { value: \"email_opened\", label: \"Email Opened\" },\r\n    { value: \"meeting_scheduled\", label: \"Meeting Scheduled\" },\r\n    { value: \"task_completed\", label: \"Task Completed\" },\r\n];\r\n\r\nconst ACTION_TYPES = [\r\n    { value: \"send_email\", label: \"Send Email\" },\r\n    { value: \"create_task\", label: \"Create Task\" },\r\n    { value: \"update_field\", label: \"Update Field\" },\r\n    { value: \"send_notification\", label: \"Send Notification\" },\r\n    { value: \"add_tag\", label: \"Add Tag\" },\r\n];\r\n\r\nconst automationSchema = z.object({\r\n    name: z.string().min(1, \"Automation name is required\"),\r\n    trigger_type: z.string().min(1, \"Trigger is required\"),\r\n    action_type: z.string().min(1, \"Action is required\"),\r\n    is_active: z.boolean().default(true),\r\n});\r\n\r\ntype AutomationFormValues = z.infer<typeof automationSchema>;\r\n\r\ninterface AutomationDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    automation?: AutomationRule | null;\r\n    organizationId: string;\r\n}\r\n\r\nexport function AutomationDialog({\r\n    open,\r\n    onOpenChange,\r\n    automation,\r\n    organizationId,\r\n}: AutomationDialogProps) {\r\n    const isEditing = !!automation;\r\n    const { trigger: createRule, isMutating: isCreating } = useCreateAutomationRule();\r\n    const { trigger: updateRule, isMutating: isUpdating } = useUpdateAutomationRule();\r\n    const isLoading = isCreating || isUpdating;\r\n\r\n    const form = useForm<AutomationFormValues>({\r\n        resolver: zodResolver(automationSchema) as any,\r\n        defaultValues: {\r\n            name: \"\",\r\n            trigger_type: \"\",\r\n            action_type: \"\",\r\n            is_active: true,\r\n        },\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (automation) {\r\n            form.reset({\r\n                name: automation.name,\r\n                trigger_type: automation.trigger_type,\r\n                action_type: automation.actions[0]?.type || \"\",\r\n                is_active: automation.is_active,\r\n            });\r\n        } else {\r\n            form.reset({\r\n                name: \"\",\r\n                trigger_type: \"\",\r\n                action_type: \"\",\r\n                is_active: true,\r\n            });\r\n        }\r\n    }, [automation, form]);\r\n\r\n    const onSubmit = async (values: AutomationFormValues) => {\r\n        try {\r\n            const ruleData = {\r\n                name: values.name,\r\n                trigger_type: values.trigger_type,\r\n                trigger_config: {},\r\n                actions: [\r\n                    {\r\n                        id: crypto.randomUUID(),\r\n                        type: values.action_type,\r\n                        config: {},\r\n                        order: 0,\r\n                    },\r\n                ],\r\n                is_active: values.is_active,\r\n                organization_id: organizationId,\r\n            };\r\n\r\n            if (isEditing && automation) {\r\n                await updateRule({\r\n                    id: automation.id,\r\n                    updates: ruleData,\r\n                });\r\n                toast.success(\"Automation updated successfully\");\r\n            } else {\r\n                await createRule(ruleData);\r\n                toast.success(\"Automation created successfully\");\r\n            }\r\n            onOpenChange(false);\r\n            form.reset();\r\n        } catch (error) {\r\n            console.error(\"Failed to save automation:\", error);\r\n            toast.error(\"Failed to save automation\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>\r\n                        {isEditing ? \"Edit Automation\" : \"Create Automation\"}\r\n                    </DialogTitle>\r\n                    <DialogDescription>\r\n                        {isEditing\r\n                            ? \"Update your workflow automation\"\r\n                            : \"Create a new automation to streamline your workflow\"}\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <Form {...form}>\r\n                    <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"name\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Automation Name</FormLabel>\r\n                                    <FormControl>\r\n                                        <Input\r\n                                            placeholder=\"e.g., New Lead  Welcome Email\"\r\n                                            {...field}\r\n                                        />\r\n                                    </FormControl>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"trigger_type\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>When this happens (Trigger)</FormLabel>\r\n                                    <Select\r\n                                        onValueChange={field.onChange}\r\n                                        defaultValue={field.value}\r\n                                    >\r\n                                        <FormControl>\r\n                                            <SelectTrigger>\r\n                                                <SelectValue placeholder=\"Select a trigger\" />\r\n                                            </SelectTrigger>\r\n                                        </FormControl>\r\n                                        <SelectContent>\r\n                                            {TRIGGER_TYPES.map((trigger) => (\r\n                                                <SelectItem\r\n                                                    key={trigger.value}\r\n                                                    value={trigger.value}\r\n                                                >\r\n                                                    {trigger.label}\r\n                                                </SelectItem>\r\n                                            ))}\r\n                                        </SelectContent>\r\n                                    </Select>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"action_type\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Do this (Action)</FormLabel>\r\n                                    <Select\r\n                                        onValueChange={field.onChange}\r\n                                        defaultValue={field.value}\r\n                                    >\r\n                                        <FormControl>\r\n                                            <SelectTrigger>\r\n                                                <SelectValue placeholder=\"Select an action\" />\r\n                                            </SelectTrigger>\r\n                                        </FormControl>\r\n                                        <SelectContent>\r\n                                            {ACTION_TYPES.map((action) => (\r\n                                                <SelectItem\r\n                                                    key={action.value}\r\n                                                    value={action.value}\r\n                                                >\r\n                                                    {action.label}\r\n                                                </SelectItem>\r\n                                            ))}\r\n                                        </SelectContent>\r\n                                    </Select>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"is_active\"\r\n                            render={({ field }) => (\r\n                                <FormItem className=\"flex items-center justify-between rounded-lg border p-3\">\r\n                                    <div className=\"space-y-0.5\">\r\n                                        <FormLabel>Active</FormLabel>\r\n                                        <p className=\"text-sm text-muted-foreground\">\r\n                                            Enable or disable this automation\r\n                                        </p>\r\n                                    </div>\r\n                                    <FormControl>\r\n                                        <Switch\r\n                                            checked={field.value}\r\n                                            onCheckedChange={field.onChange}\r\n                                        />\r\n                                    </FormControl>\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <DialogFooter>\r\n                            <Button\r\n                                type=\"button\"\r\n                                variant=\"outline\"\r\n                                onClick={() => onOpenChange(false)}\r\n                            >\r\n                                Cancel\r\n                            </Button>\r\n                            <Button type=\"submit\" disabled={isLoading}>\r\n                                {isLoading && (\r\n                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                )}\r\n                                {isEditing ? \"Save Changes\" : \"Create Automation\"}\r\n                            </Button>\r\n                        </DialogFooter>\r\n                    </form>\r\n                </Form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\calendar\\event-dialog.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'supabase.auth'. Either include it or remove the dependency array.","line":83,"column":8,"nodeType":"ArrayExpression","endLine":83,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [supabase.auth]","fix":{"range":[2426,2428],"text":"[supabase.auth]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport { format } from \"date-fns\";\r\nimport { Calendar as CalendarIcon, Clock, Loader2 } from \"lucide-react\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport {\r\n    Form,\r\n    FormControl,\r\n    FormField,\r\n    FormItem,\r\n    FormLabel,\r\n    FormMessage,\r\n} from \"@/components/ui/form\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport {\r\n    Popover,\r\n    PopoverContent,\r\n    PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useCreateCalendarEvent } from \"@/hooks/use-data\";\r\nimport { toast } from \"sonner\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\n\r\nconst formSchema = z.object({\r\n    title: z.string().min(1, \"Title is required\"),\r\n    description: z.string().optional(),\r\n    start_date: z.date(),\r\n    start_time: z.string(),\r\n    end_date: z.date(),\r\n    end_time: z.string(),\r\n    all_day: z.boolean(),\r\n});\r\n\r\ntype FormValues = z.infer<typeof formSchema>;\r\n\r\ninterface EventDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    selectedDate?: Date | null;\r\n    onSuccess?: () => void;\r\n}\r\n\r\nexport function EventDialog({\r\n    open,\r\n    onOpenChange,\r\n    selectedDate,\r\n    onSuccess,\r\n}: EventDialogProps) {\r\n    const [userId, setUserId] = useState<string | null>(null);\r\n    const [orgId, setOrgId] = useState<string | null>(null);\r\n\r\n    const { trigger: createEvent, isMutating } = useCreateCalendarEvent();\r\n    const supabase = createClient();\r\n\r\n    useEffect(() => {\r\n        async function getUser() {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (user) {\r\n                setUserId(user.id);\r\n                // In a real app, we'd fetch the user's org ID from their profile\r\n                // For now using the demo org ID\r\n                setOrgId(\"00000000-0000-0000-0000-000000000001\");\r\n            }\r\n        }\r\n        getUser();\r\n    }, []);\r\n\r\n    const form = useForm<FormValues>({\r\n        resolver: zodResolver(formSchema),\r\n        defaultValues: {\r\n            title: \"\",\r\n            description: \"\",\r\n            start_date: new Date(),\r\n            start_time: \"09:00\",\r\n            end_date: new Date(),\r\n            end_time: \"10:00\",\r\n            all_day: false,\r\n        },\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (selectedDate) {\r\n            form.setValue(\"start_date\", selectedDate);\r\n            form.setValue(\"end_date\", selectedDate);\r\n        }\r\n    }, [selectedDate, form]);\r\n\r\n    async function onSubmit(values: FormValues) {\r\n        if (!userId || !orgId) {\r\n            toast.error(\"You must be logged in to create events\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Combine date and time\r\n            const startDateTime = new Date(values.start_date);\r\n            const [startHours, startMinutes] = values.start_time.split(\":\").map(Number);\r\n            startDateTime.setHours(startHours, startMinutes);\r\n\r\n            const endDateTime = new Date(values.end_date);\r\n            const [endHours, endMinutes] = values.end_time.split(\":\").map(Number);\r\n            endDateTime.setHours(endHours, endMinutes);\r\n\r\n            await createEvent({\r\n                organization_id: orgId,\r\n                title: values.title,\r\n                description: values.description,\r\n                start_time: startDateTime.toISOString(),\r\n                end_time: endDateTime.toISOString(),\r\n                all_day: values.all_day,\r\n                created_by: userId,\r\n            });\r\n\r\n            toast.success(\"Event created successfully\");\r\n            form.reset();\r\n            onOpenChange(false);\r\n            onSuccess?.();\r\n        } catch (error) {\r\n            console.error(error);\r\n            toast.error(\"Failed to create event\");\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Add Event</DialogTitle>\r\n                    <DialogDescription>\r\n                        Schedule a new meeting or event on your calendar.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n                <Form {...form}>\r\n                    <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"title\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Event Title</FormLabel>\r\n                                    <FormControl>\r\n                                        <Input placeholder=\"Meeting with Client\" {...field} />\r\n                                    </FormControl>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <FormField\r\n                                control={form.control}\r\n                                name=\"start_date\"\r\n                                render={({ field }) => (\r\n                                    <FormItem className=\"flex flex-col\">\r\n                                        <FormLabel>Start Date</FormLabel>\r\n                                        <Popover>\r\n                                            <PopoverTrigger asChild>\r\n                                                <FormControl>\r\n                                                    <Button\r\n                                                        variant={\"outline\"}\r\n                                                        className={cn(\r\n                                                            \"w-full pl-3 text-left font-normal\",\r\n                                                            !field.value && \"text-muted-foreground\"\r\n                                                        )}\r\n                                                    >\r\n                                                        {field.value ? (\r\n                                                            format(field.value, \"PPP\")\r\n                                                        ) : (\r\n                                                            <span>Pick a date</span>\r\n                                                        )}\r\n                                                        <CalendarIcon className=\"ml-auto h-4 w-4 opacity-50\" />\r\n                                                    </Button>\r\n                                                </FormControl>\r\n                                            </PopoverTrigger>\r\n                                            <PopoverContent className=\"w-auto p-0\" align=\"start\">\r\n                                                <Calendar\r\n                                                    mode=\"single\"\r\n                                                    selected={field.value}\r\n                                                    onSelect={field.onChange}\r\n                                                    initialFocus\r\n                                                />\r\n                                            </PopoverContent>\r\n                                        </Popover>\r\n                                        <FormMessage />\r\n                                    </FormItem>\r\n                                )}\r\n                            />\r\n                            <FormField\r\n                                control={form.control}\r\n                                name=\"start_time\"\r\n                                render={({ field }) => (\r\n                                    <FormItem>\r\n                                        <FormLabel>Start Time</FormLabel>\r\n                                        <FormControl>\r\n                                            <div className=\"relative\">\r\n                                                <Clock className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground opacity-50\" />\r\n                                                <Input type=\"time\" className=\"pl-9\" {...field} />\r\n                                            </div>\r\n                                        </FormControl>\r\n                                        <FormMessage />\r\n                                    </FormItem>\r\n                                )}\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <FormField\r\n                                control={form.control}\r\n                                name=\"end_date\"\r\n                                render={({ field }) => (\r\n                                    <FormItem className=\"flex flex-col\">\r\n                                        <FormLabel>End Date</FormLabel>\r\n                                        <Popover>\r\n                                            <PopoverTrigger asChild>\r\n                                                <FormControl>\r\n                                                    <Button\r\n                                                        variant={\"outline\"}\r\n                                                        className={cn(\r\n                                                            \"w-full pl-3 text-left font-normal\",\r\n                                                            !field.value && \"text-muted-foreground\"\r\n                                                        )}\r\n                                                    >\r\n                                                        {field.value ? (\r\n                                                            format(field.value, \"PPP\")\r\n                                                        ) : (\r\n                                                            <span>Pick a date</span>\r\n                                                        )}\r\n                                                        <CalendarIcon className=\"ml-auto h-4 w-4 opacity-50\" />\r\n                                                    </Button>\r\n                                                </FormControl>\r\n                                            </PopoverTrigger>\r\n                                            <PopoverContent className=\"w-auto p-0\" align=\"start\">\r\n                                                <Calendar\r\n                                                    mode=\"single\"\r\n                                                    selected={field.value}\r\n                                                    onSelect={field.onChange}\r\n                                                    initialFocus\r\n                                                />\r\n                                            </PopoverContent>\r\n                                        </Popover>\r\n                                        <FormMessage />\r\n                                    </FormItem>\r\n                                )}\r\n                            />\r\n                            <FormField\r\n                                control={form.control}\r\n                                name=\"end_time\"\r\n                                render={({ field }) => (\r\n                                    <FormItem>\r\n                                        <FormLabel>End Time</FormLabel>\r\n                                        <FormControl>\r\n                                            <div className=\"relative\">\r\n                                                <Clock className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground opacity-50\" />\r\n                                                <Input type=\"time\" className=\"pl-9\" {...field} />\r\n                                            </div>\r\n                                        </FormControl>\r\n                                        <FormMessage />\r\n                                    </FormItem>\r\n                                )}\r\n                            />\r\n                        </div>\r\n\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"all_day\"\r\n                            render={({ field }) => (\r\n                                <FormItem className=\"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4\">\r\n                                    <FormControl>\r\n                                        <Checkbox\r\n                                            checked={field.value}\r\n                                            onCheckedChange={field.onChange}\r\n                                        />\r\n                                    </FormControl>\r\n                                    <div className=\"space-y-1 leading-none\">\r\n                                        <FormLabel>All day event</FormLabel>\r\n                                    </div>\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"description\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Description</FormLabel>\r\n                                    <FormControl>\r\n                                        <Textarea\r\n                                            placeholder=\"Add details about the event...\"\r\n                                            className=\"resize-none\"\r\n                                            {...field}\r\n                                        />\r\n                                    </FormControl>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <DialogFooter>\r\n                            <Button type=\"submit\" disabled={isMutating}>\r\n                                {isMutating && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                                Create Event\r\n                            </Button>\r\n                        </DialogFooter>\r\n                    </form>\r\n                </Form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\contacts\\contact-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":141,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4278,4281],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4278,4281],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":141,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4305,4308],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4305,4308],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/incompatible-library","severity":1,"message":"Compilation Skipped: Use of incompatible library\n\nThis API returns functions which cannot be memoized without leading to stale UI. To prevent this, by default React Compiler will skip memoizing this component/hook. However, you may see issues if values from this API are passed to other components/hooks that are memoized.\n\nC:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\contacts\\contact-dialog.tsx:235:40\n  233 |                             <Label htmlFor=\"status\">Status</Label>\n  234 |                             <Select\n> 235 |                                 value={watch(\"status\")}\n      |                                        ^^^^^ React Hook Form's `useForm()` API returns a `watch()` function which cannot be memoized safely.\n  236 |                                 onValueChange={(value) => setValue(\"status\", value)}\n  237 |                             >\n  238 |                                 <SelectTrigger>","line":235,"column":40,"nodeType":null,"endLine":235,"endColumn":45}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { toast } from \"sonner\";\r\nimport { useCreateContact, useUpdateContact, useContactStatuses } from \"@/hooks/use-data\";\r\nimport type { Contact } from \"@/types\";\r\n\r\ninterface ContactFormData {\r\n    first_name: string;\r\n    last_name: string;\r\n    email: string;\r\n    phone: string;\r\n    company: string;\r\n    job_title: string;\r\n    status: string;\r\n    lead_score: number;\r\n}\r\n\r\ninterface ContactDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    contact?: Contact | null;\r\n    organizationId: string;\r\n    onSuccess?: () => void;\r\n}\r\n\r\nexport function ContactDialog({\r\n    open,\r\n    onOpenChange,\r\n    contact,\r\n    organizationId,\r\n    onSuccess,\r\n}: ContactDialogProps) {\r\n    const isEditing = !!contact;\r\n    const { trigger: createContact, isMutating: isCreating } = useCreateContact();\r\n    const { trigger: updateContact, isMutating: isUpdating } = useUpdateContact();\r\n    const { data: statuses } = useContactStatuses();\r\n\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        reset,\r\n        setValue,\r\n        watch,\r\n        formState: { errors },\r\n    } = useForm<ContactFormData>({\r\n        defaultValues: contact\r\n            ? {\r\n                first_name: contact.first_name,\r\n                last_name: contact.last_name || \"\",\r\n                email: contact.email || \"\",\r\n                phone: contact.phone || \"\",\r\n                company: contact.company || \"\",\r\n                job_title: contact.job_title || \"\",\r\n                status: contact.status || \"new\",\r\n                lead_score: contact.lead_score || 0,\r\n            }\r\n            : {\r\n                first_name: \"\",\r\n                last_name: \"\",\r\n                email: \"\",\r\n                phone: \"\",\r\n                company: \"\",\r\n                job_title: \"\",\r\n                status: \"new\",\r\n                lead_score: 0,\r\n            },\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (contact) {\r\n            reset({\r\n                first_name: contact.first_name,\r\n                last_name: contact.last_name || \"\",\r\n                email: contact.email || \"\",\r\n                phone: contact.phone || \"\",\r\n                company: contact.company || \"\",\r\n                job_title: contact.job_title || \"\",\r\n                status: contact.status || \"new\",\r\n                lead_score: Number(contact.lead_score) || 0,\r\n            });\r\n        } else {\r\n            reset({\r\n                first_name: \"\",\r\n                last_name: \"\",\r\n                email: \"\",\r\n                phone: \"\",\r\n                company: \"\",\r\n                job_title: \"\",\r\n                status: \"new\",\r\n                lead_score: 0,\r\n            });\r\n        }\r\n    }, [contact, reset]);\r\n\r\n    const onSubmit = async (data: ContactFormData) => {\r\n        try {\r\n            if (isEditing && contact) {\r\n                await updateContact({\r\n                    id: contact.id,\r\n                    updates: {\r\n                        ...data,\r\n                        lead_score: Number(data.lead_score),\r\n                    },\r\n                });\r\n                toast.success(\"Contact updated successfully\");\r\n            } else {\r\n                await createContact({\r\n                    ...data,\r\n                    organization_id: organizationId,\r\n                    tags: [],\r\n                    custom_fields: {},\r\n                    lead_score: Number(data.lead_score),\r\n                });\r\n                toast.success(\"Contact created successfully\");\r\n            }\r\n            reset();\r\n            onOpenChange(false);\r\n            onSuccess?.();\r\n        } catch (error) {\r\n            console.error(\"Error saving contact:\", error);\r\n            const errorMessage = (error as any)?.message || (error as any)?.details || \"Failed to save contact\";\r\n            toast.error(`Error: ${errorMessage}`);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>\r\n                        {isEditing ? \"Edit Contact\" : \"Add New Contact\"}\r\n                    </DialogTitle>\r\n                    <DialogDescription>\r\n                        {isEditing\r\n                            ? \"Update the contact's information.\"\r\n                            : \"Fill in the details to create a new contact.\"}\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"first_name\">First Name *</Label>\r\n                            <Input\r\n                                id=\"first_name\"\r\n                                {...register(\"first_name\", { required: \"First name is required\" })}\r\n                                placeholder=\"John\"\r\n                            />\r\n                            {errors.first_name && (\r\n                                <p className=\"text-xs text-destructive\">\r\n                                    {errors.first_name.message}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"last_name\">Last Name</Label>\r\n                            <Input\r\n                                id=\"last_name\"\r\n                                {...register(\"last_name\")}\r\n                                placeholder=\"Smith\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"email\">Email</Label>\r\n                        <Input\r\n                            id=\"email\"\r\n                            type=\"email\"\r\n                            {...register(\"email\", {\r\n                                pattern: {\r\n                                    value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,\r\n                                    message: \"Invalid email address\",\r\n                                },\r\n                            })}\r\n                            placeholder=\"john@company.com\"\r\n                        />\r\n                        {errors.email && (\r\n                            <p className=\"text-xs text-destructive\">{errors.email.message}</p>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"phone\">Phone</Label>\r\n                        <Input\r\n                            id=\"phone\"\r\n                            {...register(\"phone\")}\r\n                            placeholder=\"+1 (555) 123-4567\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"company\">Company</Label>\r\n                            <Input\r\n                                id=\"company\"\r\n                                {...register(\"company\")}\r\n                                placeholder=\"Acme Inc\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"job_title\">Job Title</Label>\r\n                            <Input\r\n                                id=\"job_title\"\r\n                                {...register(\"job_title\")}\r\n                                placeholder=\"CEO\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"status\">Status</Label>\r\n                            <Select\r\n                                value={watch(\"status\")}\r\n                                onValueChange={(value) => setValue(\"status\", value)}\r\n                            >\r\n                                <SelectTrigger>\r\n                                    <SelectValue placeholder=\"Select status\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    {statuses?.map((s) => (\r\n                                        <SelectItem key={s.id} value={s.name}>\r\n                                            {s.label}\r\n                                        </SelectItem>\r\n                                    ))}\r\n                                    {!statuses && (\r\n                                        <>\r\n                                            <SelectItem value=\"new\">New</SelectItem>\r\n                                            <SelectItem value=\"contacted\">Contacted</SelectItem>\r\n                                            <SelectItem value=\"qualified\">Qualified</SelectItem>\r\n                                            <SelectItem value=\"unqualified\">Unqualified</SelectItem>\r\n                                            <SelectItem value=\"customer\">Customer</SelectItem>\r\n                                        </>\r\n                                    )}\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"lead_score\">Lead Score</Label>\r\n                            <Input\r\n                                id=\"lead_score\"\r\n                                type=\"number\"\r\n                                {...register(\"lead_score\")}\r\n                                placeholder=\"0\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <DialogFooter>\r\n                        <Button\r\n                            type=\"button\"\r\n                            variant=\"outline\"\r\n                            onClick={() => onOpenChange(false)}\r\n                        >\r\n                            Cancel\r\n                        </Button>\r\n                        <Button type=\"submit\" disabled={isCreating || isUpdating}>\r\n                            {isCreating || isUpdating\r\n                                ? \"Saving...\"\r\n                                : isEditing\r\n                                    ? \"Update Contact\"\r\n                                    : \"Create Contact\"}\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\contacts\\contact-filters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\contacts\\import-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileText"},"fix":{"range":[75,85],"text":""},"desc":"Remove unused variable \"FileText\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle2' is defined but never used.","line":4,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":40,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle2"},"fix":{"range":[85,99],"text":""},"desc":"Remove unused variable \"CheckCircle2\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":117,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4258,4261],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4258,4261],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useRef } from \"react\";\r\nimport { Upload, FileText, CheckCircle2, AlertCircle, Download, Loader2 } from \"lucide-react\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogFooter,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { toast } from \"sonner\";\r\nimport { useBulkCreateContacts } from \"@/hooks/use-data\";\r\nimport Papa from \"papaparse\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\";\r\n\r\ninterface ImportDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    organizationId: string;\r\n    onSuccess?: () => void;\r\n}\r\n\r\nexport function ImportDialog({\r\n    open,\r\n    onOpenChange,\r\n    organizationId,\r\n    onSuccess,\r\n}: ImportDialogProps) {\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n    const [file, setFile] = useState<File | null>(null);\r\n    const [preview, setPreview] = useState<Record<string, string>[]>([]);\r\n    const { trigger: bulkCreate, isMutating: isImporting } = useBulkCreateContacts();\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const selectedFile = e.target.files?.[0];\r\n        if (selectedFile) {\r\n            if (selectedFile.type !== \"text/csv\") {\r\n                toast.error(\"Only CSV files are accepted\");\r\n                return;\r\n            }\r\n            setFile(selectedFile);\r\n\r\n            // Parse for preview\r\n            Papa.parse(selectedFile, {\r\n                header: true,\r\n                preview: 5,\r\n                complete: (results) => {\r\n                    setPreview(results.data as Record<string, string>[]);\r\n                },\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleDownloadTemplate = () => {\r\n        const headers = [\"first_name\", \"last_name\", \"email\", \"phone\", \"company\", \"job_title\", \"status\", \"lead_score\"];\r\n        const sampleRows = [\r\n            [\"John\", \"Doe\", \"john@example.com\", \"+123456789\", \"Acme Corp\", \"Manager\", \"new\", \"85\"],\r\n            [\"Jane\", \"Smith\", \"jane@example.com\", \"+987654321\", \"Globex\", \"CEO\", \"qualified\", \"95\"]\r\n        ];\r\n\r\n        const csvContent = [headers, ...sampleRows].map(e => e.join(\",\")).join(\"\\n\");\r\n        const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n        const link = document.createElement(\"a\");\r\n        const url = URL.createObjectURL(blob);\r\n        link.setAttribute(\"href\", url);\r\n        link.setAttribute(\"download\", \"contacts_import_template.csv\");\r\n        link.style.visibility = 'hidden';\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    };\r\n\r\n    const handleImport = async () => {\r\n        if (!file) return;\r\n\r\n        Papa.parse(file, {\r\n            header: true,\r\n            skipEmptyLines: true,\r\n            complete: async (results) => {\r\n                const contactsToCreate = (results.data as Record<string, string>[]).map((row) => ({\r\n                    organization_id: organizationId,\r\n                    first_name: row.first_name || \"Unknown\",\r\n                    last_name: row.last_name || null,\r\n                    email: row.email || null,\r\n                    phone: row.phone || null,\r\n                    company: row.company || null,\r\n                    job_title: row.job_title || null,\r\n                    status: row.status || \"new\",\r\n                    lead_score: Number(row.lead_score) || 0,\r\n                    tags: [],\r\n                    custom_fields: {},\r\n                }));\r\n\r\n                if (contactsToCreate.length === 0) {\r\n                    toast.error(\"No valid contacts found in CSV\");\r\n                    return;\r\n                }\r\n\r\n                try {\r\n                    await bulkCreate(contactsToCreate);\r\n                    toast.success(`Successfully imported ${contactsToCreate.length} contacts`);\r\n                    onOpenChange(false);\r\n                    onSuccess?.();\r\n                    setFile(null);\r\n                    setPreview([]);\r\n                } catch (error: any) {\r\n                    console.error(\"Import error details:\", {\r\n                        message: error.message,\r\n                        details: error.details,\r\n                        hint: error.hint,\r\n                        code: error.code,\r\n                        error\r\n                    });\r\n                    toast.error(`Import failed: ${error.message || \"Please check your file format\"}`);\r\n                }\r\n            },\r\n        });\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[600px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Import Contacts</DialogTitle>\r\n                    <DialogDescription>\r\n                        Upload a CSV file to bulk import contacts into your CRM.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-6 py-4\">\r\n                    <div className=\"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-12 space-y-4 hover:bg-muted/50 transition-colors cursor-pointer\" onClick={() => fileInputRef.current?.click()}>\r\n                        <input\r\n                            type=\"file\"\r\n                            ref={fileInputRef}\r\n                            className=\"hidden\"\r\n                            accept=\".csv\"\r\n                            onChange={handleFileChange}\r\n                        />\r\n                        <div className=\"p-4 rounded-full bg-primary/10\">\r\n                            <Upload className=\"h-8 w-8 text-primary\" />\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                            <p className=\"text-sm font-medium\">\r\n                                {file ? file.name : \"Click to select or drag and drop CSV file\"}\r\n                            </p>\r\n                            <p className=\"text-xs text-muted-foreground mt-1\">\r\n                                Only .csv files are supported\r\n                            </p>\r\n                        </div>\r\n                        {file && (\r\n                            <Button variant=\"outline\" size=\"sm\" onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                setFile(null);\r\n                                setPreview([]);\r\n                            }}>\r\n                                Change File\r\n                            </Button>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <Label className=\"text-sm font-medium\">Sample Data Format</Label>\r\n                            <Button variant=\"link\" size=\"sm\" className=\"h-auto p-0\" onClick={handleDownloadTemplate}>\r\n                                <Download className=\"h-3.5 w-3.5 mr-1\" />\r\n                                Download Template\r\n                            </Button>\r\n                        </div>\r\n\r\n                        {preview.length > 0 ? (\r\n                            <div className=\"rounded-md border overflow-hidden\">\r\n                                <Table>\r\n                                    <TableHeader>\r\n                                        <TableRow className=\"bg-muted/50\">\r\n                                            <TableHead className=\"text-[10px] uppercase font-bold py-2\">First Name</TableHead>\r\n                                            <TableHead className=\"text-[10px] uppercase font-bold py-2\">Email</TableHead>\r\n                                            <TableHead className=\"text-[10px] uppercase font-bold py-2\">Company</TableHead>\r\n                                            <TableHead className=\"text-[10px] uppercase font-bold py-2\">Status</TableHead>\r\n                                        </TableRow>\r\n                                    </TableHeader>\r\n                                    <TableBody>\r\n                                        {preview.map((row, i) => (\r\n                                            <TableRow key={i}>\r\n                                                <TableCell className=\"text-xs py-2\">{row.first_name}</TableCell>\r\n                                                <TableCell className=\"text-xs py-2\">{row.email}</TableCell>\r\n                                                <TableCell className=\"text-xs py-2\">{row.company}</TableCell>\r\n                                                <TableCell className=\"text-xs py-2\">{row.status}</TableCell>\r\n                                            </TableRow>\r\n                                        ))}\r\n                                    </TableBody>\r\n                                </Table>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"rounded-lg border bg-muted/30 p-4 space-y-2\">\r\n                                <div className=\"flex items-center gap-2 text-sm font-semibold\">\r\n                                    <AlertCircle className=\"h-4 w-4 text-primary\" />\r\n                                    Requirements\r\n                                </div>\r\n                                <p className=\"text-xs text-muted-foreground leading-relaxed\">\r\n                                    Your CSV must contain the following required header: <code className=\"bg-muted px-1 rounded font-mono\">first_name</code>.\r\n                                    Optional headers include: last_name, email, phone, company, status, lead_score.\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <DialogFooter>\r\n                    <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={isImporting}>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={handleImport} disabled={!file || isImporting}>\r\n                        {isImporting ? (\r\n                            <>\r\n                                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                Importing...\r\n                            </>\r\n                        ) : (\r\n                            \"Start Import\"\r\n                        )}\r\n                    </Button>\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\contacts\\status-management-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useUpdateContactStatus' is defined but never used.","line":19,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":27,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useUpdateContactStatus"},"fix":{"range":[490,519],"text":""},"desc":"Remove unused variable \"useUpdateContactStatus\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1694,1697],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1694,1697],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2223,2226],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2223,2226],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Plus, Trash2, GripVertical } from \"lucide-react\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n    useContactStatuses,\r\n    useCreateContactStatus,\r\n    useUpdateContactStatus,\r\n    useDeleteContactStatus\r\n} from \"@/hooks/use-data\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\n\r\ninterface StatusManagementDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    organizationId: string;\r\n}\r\n\r\nexport function StatusManagementDialog({\r\n    open,\r\n    onOpenChange,\r\n    organizationId,\r\n}: StatusManagementDialogProps) {\r\n    const { data: statuses, mutate } = useContactStatuses();\r\n    const { trigger: createStatus } = useCreateContactStatus();\r\n    const { trigger: deleteStatus } = useDeleteContactStatus();\r\n\r\n    const [newStatusLabel, setNewStatusLabel] = useState(\"\");\r\n\r\n    const handleAddStatus = async () => {\r\n        if (!newStatusLabel.trim()) return;\r\n\r\n        try {\r\n            await createStatus({\r\n                organization_id: organizationId,\r\n                name: newStatusLabel.toLowerCase().replace(/\\s+/g, \"_\"),\r\n                label: newStatusLabel,\r\n                color: \"gray\",\r\n                order: (statuses?.length || 0) + 1,\r\n            });\r\n            setNewStatusLabel(\"\");\r\n            toast.success(\"Status added\");\r\n            mutate();\r\n        } catch (error: any) {\r\n            console.error(\"Error adding status:\", error);\r\n            toast.error(`Failed to add status: ${error.message || \"Unknown error\"}`);\r\n        }\r\n    };\r\n\r\n    const handleDeleteStatus = async (id: string) => {\r\n        if (id.startsWith(\"default-\")) {\r\n            toast.error(\"Default statuses cannot be deleted in this demo\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await deleteStatus(id);\r\n            toast.success(\"Status deleted\");\r\n            mutate();\r\n        } catch (error: any) {\r\n            console.error(\"Error deleting status:\", error);\r\n            toast.error(`Failed to delete status: ${error.message || \"Unknown error\"}`);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[425px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Manage Contact Statuses</DialogTitle>\r\n                    <DialogDescription>\r\n                        Add, remove, or customize the statuses for your contacts.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-4 py-4\">\r\n                    <div className=\"space-y-2\">\r\n                        <Label>Add New Status</Label>\r\n                        <div className=\"flex gap-2\">\r\n                            <Input\r\n                                placeholder=\"e.g. In Progress\"\r\n                                value={newStatusLabel}\r\n                                onChange={(e) => setNewStatusLabel(e.target.value)}\r\n                                onKeyDown={(e) => e.key === \"Enter\" && handleAddStatus()}\r\n                            />\r\n                            <Button onClick={handleAddStatus} size=\"icon\">\r\n                                <Plus className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <Separator />\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label>Existing Statuses</Label>\r\n                        <div className=\"space-y-2\">\r\n                            {statuses?.map((status) => (\r\n                                <div\r\n                                    key={status.id}\r\n                                    className=\"flex items-center justify-between p-2 rounded-md border bg-muted/50\"\r\n                                >\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <GripVertical className=\"h-4 w-4 text-muted-foreground\" />\r\n                                        <span className=\"text-sm font-medium\">{status.label}</span>\r\n                                    </div>\r\n                                    <Button\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8 text-destructive\"\r\n                                        onClick={() => handleDeleteStatus(status.id)}\r\n                                    >\r\n                                        <Trash2 className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-end\">\r\n                    <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n                        Close\r\n                    </Button>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\copilot\\copilot-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\copilot\\copilot-widget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\dashboard\\ai-assistant.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageSquare' is defined but never used.","line":5,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":47,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MessageSquare"},"fix":{"range":[160,175],"text":""},"desc":"Remove unused variable \"MessageSquare\"."}]},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\dashboard\\ai-assistant.tsx:46:17\n  44 |\n  45 |         const userMsg: Message = {\n> 46 |             id: Date.now().toString(),\n     |                 ^^^^^^^^^^ Cannot call impure function\n  47 |             role: \"user\",\n  48 |             content: input,\n  49 |             timestamp: new Date(),","line":46,"column":17,"nodeType":null,"endLine":46,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Bot, X, Send, Sparkles, MessageSquare, Maximize2, Minimize2, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useActiveProfile } from \"@/hooks/use-data\";\r\n\r\ntype Message = {\r\n    id: string;\r\n    role: \"user\" | \"assistant\";\r\n    content: string;\r\n    timestamp: Date;\r\n};\r\n\r\nexport function AIAssistant() {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [isMinimized, setIsMinimized] = useState(false);\r\n    const [input, setInput] = useState(\"\");\r\n    const [messages, setMessages] = useState<Message[]>([\r\n        {\r\n            id: \"1\",\r\n            role: \"assistant\",\r\n            content: \"Hi! I'm your CRM Copilot. I can help you summarize calls, draft emails, or look up contact info. How can I help you today?\",\r\n            timestamp: new Date(),\r\n        },\r\n    ]);\r\n    const [isTyping, setIsTyping] = useState(false);\r\n    const scrollRef = useRef<HTMLDivElement>(null);\r\n    const { data: profile } = useActiveProfile();\r\n\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n    }, [messages, isTyping]);\r\n\r\n    const handleSend = async () => {\r\n        if (!input.trim()) return;\r\n\r\n        const userMsg: Message = {\r\n            id: Date.now().toString(),\r\n            role: \"user\",\r\n            content: input,\r\n            timestamp: new Date(),\r\n        };\r\n\r\n        setMessages((prev) => [...prev, userMsg]);\r\n        setInput(\"\");\r\n        setIsTyping(true);\r\n\r\n        // Simulate AI response\r\n        setTimeout(() => {\r\n            const aiMsg: Message = {\r\n                id: (Date.now() + 1).toString(),\r\n                role: \"assistant\",\r\n                content: generateAIResponse(input),\r\n                timestamp: new Date(),\r\n            };\r\n            setMessages((prev) => [...prev, aiMsg]);\r\n            setIsTyping(false);\r\n        }, 1500);\r\n    };\r\n\r\n    const generateAIResponse = (query: string): string => {\r\n        const q = query.toLowerCase();\r\n        if (q.includes(\"hi\") || q.includes(\"hello\")) return `Hello ${profile?.full_name?.split(' ')[0] || 'there'}! How can I assist your sales efforts today?`;\r\n        if (q.includes(\"report\") || q.includes(\"stat\")) return \"I can generate a summary of your recent call volume. Your team made 124 calls today with a 45% connect rate. Would you like a detailed breakdown?\";\r\n        if (q.includes(\"contact\")) return \"I see you're looking for contact info. You can find all records in the Contacts tab, but I can pull up specific details if you give me a name.\";\r\n        if (q.includes(\"deal\")) return \"Your current pipeline value is $1.2M. You have 3 deals in the 'Negotiation' stage that need follow-up.\";\r\n        return \"That's a great question. As your CRM Copilot, I'm still learning the specifics of your data, but I can help you with general automation and drafting. Want to try drafting an email?\";\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed bottom-6 right-24 z-50\">\r\n            <AnimatePresence>\r\n                {isOpen && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0, y: 20, scale: 0.95 }}\r\n                        animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                        exit={{ opacity: 0, y: 20, scale: 0.95 }}\r\n                        className={cn(\r\n                            \"absolute bottom-20 right-0 w-[380px] shadow-2xl transition-all\",\r\n                            isMinimized ? \"h-14 overflow-hidden\" : \"h-[500px]\"\r\n                        )}\r\n                    >\r\n                        <Card className=\"h-full border-primary/20 flex flex-col\">\r\n                            <CardHeader className=\"p-4 bg-primary text-primary-foreground flex flex-row items-center justify-between space-y-0\">\r\n                                <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\r\n                                    <Sparkles className=\"h-4 w-4\" />\r\n                                    CRM Copilot\r\n                                </CardTitle>\r\n                                <div className=\"flex items-center gap-1\">\r\n                                    <Button\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8 text-primary-foreground hover:bg-white/10\"\r\n                                        onClick={() => setIsMinimized(!isMinimized)}\r\n                                    >\r\n                                        {isMinimized ? <Maximize2 className=\"h-4 w-4\" /> : <Minimize2 className=\"h-4 w-4\" />}\r\n                                    </Button>\r\n                                    <Button\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8 text-primary-foreground hover:bg-white/10\"\r\n                                        onClick={() => setIsOpen(false)}\r\n                                    >\r\n                                        <X className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </CardHeader>\r\n                            {!isMinimized && (\r\n                                <>\r\n                                    <CardContent className=\"flex-1 overflow-hidden p-0 bg-muted/30\">\r\n                                        <ScrollArea className=\"h-full p-4\" viewportRef={scrollRef}>\r\n                                            <div className=\"space-y-4\">\r\n                                                {messages.map((msg) => (\r\n                                                    <div\r\n                                                        key={msg.id}\r\n                                                        className={cn(\r\n                                                            \"flex flex-col max-w-[85%] gap-1\",\r\n                                                            msg.role === \"user\" ? \"ml-auto items-end\" : \"items-start\"\r\n                                                        )}\r\n                                                    >\r\n                                                        <div\r\n                                                            className={cn(\r\n                                                                \"p-3 rounded-2xl text-sm shadow-sm\",\r\n                                                                msg.role === \"user\"\r\n                                                                    ? \"bg-primary text-primary-foreground rounded-tr-none\"\r\n                                                                    : \"bg-card text-card-foreground rounded-tl-none border\"\r\n                                                            )}\r\n                                                        >\r\n                                                            {msg.content}\r\n                                                        </div>\r\n                                                        <span className=\"text-[10px] text-muted-foreground px-1\">\r\n                                                            {msg.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                ))}\r\n                                                {isTyping && (\r\n                                                    <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n                                                        <div className=\"bg-card border p-2 rounded-2xl rounded-tl-none\">\r\n                                                            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </ScrollArea>\r\n                                    </CardContent>\r\n                                    <CardFooter className=\"p-4 bg-background border-t\">\r\n                                        <form\r\n                                            onSubmit={(e) => {\r\n                                                e.preventDefault();\r\n                                                handleSend();\r\n                                            }}\r\n                                            className=\"flex w-full items-center space-x-2\"\r\n                                        >\r\n                                            <Input\r\n                                                placeholder=\"Ask Copilot...\"\r\n                                                value={input}\r\n                                                onChange={(e) => setInput(e.target.value)}\r\n                                                className=\"flex-1\"\r\n                                                disabled={isTyping}\r\n                                            />\r\n                                            <Button type=\"submit\" size=\"icon\" disabled={!input.trim() || isTyping}>\r\n                                                <Send className=\"h-4 w-4\" />\r\n                                            </Button>\r\n                                        </form>\r\n                                    </CardFooter>\r\n                                </>\r\n                            )}\r\n                        </Card>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            <motion.button\r\n                whileHover={{ scale: 1.05 }}\r\n                whileTap={{ scale: 0.95 }}\r\n                onClick={() => {\r\n                    setIsOpen(!isOpen);\r\n                    setIsMinimized(false);\r\n                }}\r\n                className={cn(\r\n                    \"h-14 w-14 rounded-full shadow-lg flex items-center justify-center transition-all\",\r\n                    isOpen ? \"bg-destructive text-destructive-foreground rotate-90\" : \"bg-primary text-primary-foreground\"\r\n                )}\r\n            >\r\n                {isOpen ? <X className=\"h-6 w-6\" /> : <Bot className=\"h-6 w-6\" />}\r\n            </motion.button>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\dashboard\\call-widget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\dashboard\\command-palette.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\dashboard\\sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\dashboard\\topbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\deals\\deal-dialog.tsx","messages":[{"ruleId":"react-hooks/incompatible-library","severity":1,"message":"Compilation Skipped: Use of incompatible library\n\nThis API returns functions which cannot be memoized without leading to stale UI. To prevent this, by default React Compiler will skip memoizing this component/hook. However, you may see issues if values from this API are passed to other components/hooks that are memoized.\n\nC:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\deals\\deal-dialog.tsx:111:27\n  109 |     }, [deal, reset, stages]);\n  110 |\n> 111 |     const selectedStage = watch(\"stage\");\n      |                           ^^^^^ React Hook Form's `useForm()` API returns a `watch()` function which cannot be memoized safely.\n  112 |\n  113 |     const onSubmit = async (data: DealFormData) => {\n  114 |         try {","line":111,"column":27,"nodeType":null,"endLine":111,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { toast } from \"sonner\";\r\nimport { useCreateDeal, useUpdateDeal, useContacts, useActiveProfile } from \"@/hooks/use-data\";\r\nimport type { Deal } from \"@/types\";\r\n\r\ninterface DealFormData {\r\n    name: string;\r\n    value: number;\r\n    stage: string;\r\n    probability: number;\r\n    contact_id: string;\r\n    expected_close_date: string;\r\n}\r\n\r\ninterface DealDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    deal?: Deal | null;\r\n    pipelineId: string;\r\n    organizationId: string;\r\n    stages: { id: string; name: string }[];\r\n    onSuccess?: () => void;\r\n}\r\n\r\nexport function DealDialog({\r\n    open,\r\n    onOpenChange,\r\n    deal,\r\n    pipelineId,\r\n    organizationId,\r\n    stages,\r\n    onSuccess,\r\n}: DealDialogProps) {\r\n    const isEditing = !!deal;\r\n    const { data: contacts } = useContacts();\r\n    const { data: activeProfile } = useActiveProfile();\r\n    const isAgent = activeProfile?.role === \"agent\";\r\n    const { trigger: createDeal, isMutating: isCreating } = useCreateDeal();\r\n    const { trigger: updateDeal, isMutating: isUpdating } = useUpdateDeal();\r\n\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        reset,\r\n        setValue,\r\n        watch,\r\n        formState: { errors },\r\n    } = useForm<DealFormData>({\r\n        defaultValues: deal\r\n            ? {\r\n                name: deal.name,\r\n                value: deal.value,\r\n                stage: deal.stage,\r\n                probability: deal.probability,\r\n                contact_id: deal.contact_id || \"none\",\r\n                expected_close_date: deal.expected_close_date || \"\",\r\n            }\r\n            : {\r\n                name: \"\",\r\n                value: 0,\r\n                stage: stages[0]?.id || \"lead\",\r\n                probability: 10,\r\n                contact_id: \"none\",\r\n                expected_close_date: \"\",\r\n            },\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (deal) {\r\n            reset({\r\n                name: deal.name,\r\n                value: deal.value,\r\n                stage: deal.stage,\r\n                probability: deal.probability,\r\n                contact_id: deal.contact_id || \"none\",\r\n                expected_close_date: deal.expected_close_date || \"\",\r\n            });\r\n        } else {\r\n            reset({\r\n                name: \"\",\r\n                value: 0,\r\n                stage: stages[0]?.id || \"lead\",\r\n                probability: 10,\r\n                contact_id: \"none\",\r\n                expected_close_date: \"\",\r\n            });\r\n        }\r\n    }, [deal, reset, stages]);\r\n\r\n    const selectedStage = watch(\"stage\");\r\n\r\n    const onSubmit = async (data: DealFormData) => {\r\n        try {\r\n            if (isEditing && deal) {\r\n                await updateDeal({\r\n                    id: deal.id,\r\n                    updates: {\r\n                        ...data,\r\n                        value: Number(data.value),\r\n                        probability: Number(data.probability),\r\n                        contact_id: data.contact_id === \"none\" ? null : data.contact_id,\r\n                    },\r\n                });\r\n                toast.success(\"Deal updated successfully\");\r\n            } else {\r\n                await createDeal({\r\n                    ...data,\r\n                    organization_id: organizationId,\r\n                    pipeline_id: pipelineId,\r\n                    value: Number(data.value),\r\n                    probability: Number(data.probability),\r\n                    contact_id: data.contact_id === \"none\" ? null : data.contact_id,\r\n                    currency: \"USD\",\r\n                });\r\n                toast.success(\"Deal created successfully\");\r\n            }\r\n            reset();\r\n            onOpenChange(false);\r\n            onSuccess?.();\r\n        } catch (error) {\r\n            console.error(\"Error saving deal:\", error);\r\n            toast.error(\"Failed to save deal\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>{isEditing ? \"Edit Deal\" : \"Add New Deal\"}</DialogTitle>\r\n                    <DialogDescription>\r\n                        {isEditing\r\n                            ? \"Update the deal information.\"\r\n                            : \"Fill in the details to create a new deal.\"}\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"name\">Deal Name *</Label>\r\n                        <Input\r\n                            id=\"name\"\r\n                            {...register(\"name\", { required: \"Deal name is required\" })}\r\n                            placeholder=\"Enterprise Agreement\"\r\n                        />\r\n                        {errors.name && (\r\n                            <p className=\"text-xs text-destructive\">{errors.name.message}</p>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"value\">Value ($)</Label>\r\n                            <Input\r\n                                id=\"value\"\r\n                                type=\"number\"\r\n                                step=\"0.01\"\r\n                                {...register(\"value\", { min: 0 })}\r\n                                placeholder=\"50000\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"probability\">Probability (%)</Label>\r\n                            <Input\r\n                                id=\"probability\"\r\n                                type=\"number\"\r\n                                min=\"0\"\r\n                                max=\"100\"\r\n                                {...register(\"probability\", { min: 0, max: 100 })}\r\n                                placeholder=\"50\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"stage\">Stage</Label>\r\n                        <Select\r\n                            value={selectedStage}\r\n                            onValueChange={(value) => setValue(\"stage\", value)}\r\n                        >\r\n                            <SelectTrigger>\r\n                                <SelectValue placeholder=\"Select stage\" />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                                {stages.map((stage) => (\r\n                                    <SelectItem key={stage.id} value={stage.id}>\r\n                                        {stage.name}\r\n                                    </SelectItem>\r\n                                ))}\r\n                            </SelectContent>\r\n                        </Select>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"contact_id\">Contact</Label>\r\n                        <Select\r\n                            value={watch(\"contact_id\")}\r\n                            onValueChange={(value) => setValue(\"contact_id\", value)}\r\n                        >\r\n                            <SelectTrigger>\r\n                                <SelectValue placeholder=\"Select contact (optional)\" />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                                {!isAgent && <SelectItem value=\"none\">No contact</SelectItem>}\r\n                                {contacts?.map((contact) => (\r\n                                    <SelectItem key={contact.id} value={contact.id}>\r\n                                        {contact.first_name} {contact.last_name}\r\n                                        {contact.company && ` - ${contact.company}`}\r\n                                    </SelectItem>\r\n                                ))}\r\n                            </SelectContent>\r\n                        </Select>\r\n                        {isAgent && watch(\"contact_id\") === \"none\" && (\r\n                            <p className=\"text-xs text-destructive\">Agents must link a contact to create a deal.</p>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"expected_close_date\">Expected Close Date</Label>\r\n                        <Input\r\n                            id=\"expected_close_date\"\r\n                            type=\"date\"\r\n                            {...register(\"expected_close_date\")}\r\n                        />\r\n                    </div>\r\n\r\n                    <DialogFooter>\r\n                        <Button\r\n                            type=\"button\"\r\n                            variant=\"outline\"\r\n                            onClick={() => onOpenChange(false)}\r\n                        >\r\n                            Cancel\r\n                        </Button>\r\n                        <Button type=\"submit\" disabled={isCreating || isUpdating || (isAgent && watch(\"contact_id\") === \"none\")}>\r\n                            {isCreating || isUpdating\r\n                                ? \"Saving...\"\r\n                                : isEditing\r\n                                    ? \"Update Deal\"\r\n                                    : \"Create Deal\"}\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\deals\\deal-filters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\email\\email-composer-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\email\\sequence-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2139,2142],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2139,2142],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":117,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3547,3550],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3547,3550],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":124,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3801,3804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3801,3804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useForm, useFieldArray } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogFooter,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Form,\r\n    FormControl,\r\n    FormField,\r\n    FormItem,\r\n    FormLabel,\r\n    FormMessage,\r\n} from \"@/components/ui/form\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { useEmailTemplates, useCreateEmailSequence, useUpdateEmailSequence } from \"@/hooks/use-data\";\r\nimport { toast } from \"sonner\";\r\nimport { Loader2, Plus, Trash2, Clock } from \"lucide-react\";\r\nimport { useEffect } from \"react\";\r\nimport type { EmailSequence } from \"@/types\";\r\n\r\nconst stepSchema = z.object({\r\n    id: z.string().optional(),\r\n    order: z.number(),\r\n    delay_days: z.number().min(0, \"Delay must be at least 0 days\"),\r\n    template_id: z.string().min(1, \"Template is required\"),\r\n    subject_override: z.string().optional().nullable(),\r\n});\r\n\r\nconst formSchema = z.object({\r\n    name: z.string().min(1, \"Sequence name is required\"),\r\n    steps: z.array(stepSchema).min(1, \"At least one step is required\"),\r\n    is_active: z.boolean().default(true),\r\n});\r\n\r\ninterface SequenceDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    sequence?: EmailSequence | null;\r\n    organizationId: string;\r\n    onSuccess?: () => void;\r\n}\r\n\r\nexport function SequenceDialog({\r\n    open,\r\n    onOpenChange,\r\n    sequence,\r\n    organizationId,\r\n    onSuccess,\r\n}: SequenceDialogProps) {\r\n    const { data: templates } = useEmailTemplates();\r\n    const { trigger: createSequence, isMutating: isCreating } = useCreateEmailSequence();\r\n    const { trigger: updateSequence, isMutating: isUpdating } = useUpdateEmailSequence();\r\n\r\n    const form = useForm<z.infer<typeof formSchema>>({\r\n        resolver: zodResolver(formSchema) as any,\r\n        defaultValues: {\r\n            name: \"\",\r\n            steps: [{ order: 1, delay_days: 1, template_id: \"\" }],\r\n            is_active: true,\r\n        },\r\n    });\r\n\r\n    const { fields, append, remove } = useFieldArray({\r\n        control: form.control,\r\n        name: \"steps\",\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (sequence) {\r\n            form.reset({\r\n                name: sequence.name,\r\n                steps: sequence.steps.map(s => ({\r\n                    ...s,\r\n                    subject_override: s.subject_override || null\r\n                })),\r\n                is_active: sequence.is_active,\r\n            });\r\n        } else {\r\n            form.reset({\r\n                name: \"\",\r\n                steps: [{ order: 1, delay_days: 1, template_id: \"\" }],\r\n                is_active: true,\r\n            });\r\n        }\r\n    }, [sequence, form, open]);\r\n\r\n    const onSubmit = async (values: z.infer<typeof formSchema>) => {\r\n        try {\r\n            const sequenceData = {\r\n                ...values,\r\n                steps: values.steps.map(s => ({\r\n                    ...s,\r\n                    id: s.id || undefined,\r\n                    subject_override: s.subject_override || null\r\n                }))\r\n            };\r\n\r\n            if (sequence) {\r\n                await updateSequence({\r\n                    id: sequence.id,\r\n                    updates: sequenceData as any,\r\n                });\r\n                toast.success(\"Sequence updated\");\r\n            } else {\r\n                await createSequence({\r\n                    ...sequenceData,\r\n                    organization_id: organizationId,\r\n                } as any);\r\n                toast.success(\"Sequence created\");\r\n            }\r\n            onSuccess?.();\r\n            onOpenChange(false);\r\n        } catch (error) {\r\n            console.error(\"Failed to save sequence:\", error);\r\n            toast.error(\"Failed to save sequence\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\r\n                <DialogHeader>\r\n                    <DialogTitle>{sequence ? \"Edit Sequence\" : \"New Sequence\"}</DialogTitle>\r\n                    <DialogDescription>\r\n                        Define the steps and timing for your automated email sequence.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <Form {...form}>\r\n                    <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"name\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Sequence Name</FormLabel>\r\n                                    <FormControl>\r\n                                        <Input placeholder=\"e.g. Onboarding Nurture\" {...field} />\r\n                                    </FormControl>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <div className=\"space-y-4\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                                <h4 className=\"text-sm font-semibold\">Sequence Steps</h4>\r\n                                <Button\r\n                                    type=\"button\"\r\n                                    variant=\"outline\"\r\n                                    size=\"sm\"\r\n                                    onClick={() =>\r\n                                        append({\r\n                                            order: fields.length + 1,\r\n                                            delay_days: 3,\r\n                                            template_id: \"\",\r\n                                        })\r\n                                    }\r\n                                >\r\n                                    <Plus className=\"h-4 w-4 mr-2\" />\r\n                                    Add Step\r\n                                </Button>\r\n                            </div>\r\n\r\n                            {fields.map((field, index) => (\r\n                                <div\r\n                                    key={field.id}\r\n                                    className=\"p-4 rounded-lg border bg-muted/30 space-y-4 relative\"\r\n                                >\r\n                                    <div className=\"flex items-center justify-between\">\r\n                                        <Badge variant=\"outline\">Step {index + 1}</Badge>\r\n                                        {fields.length > 1 && (\r\n                                            <Button\r\n                                                type=\"button\"\r\n                                                variant=\"ghost\"\r\n                                                size=\"icon\"\r\n                                                className=\"h-8 w-8 text-destructive\"\r\n                                                onClick={() => remove(index)}\r\n                                            >\r\n                                                <Trash2 className=\"h-4 w-4\" />\r\n                                            </Button>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                                        <FormField\r\n                                            control={form.control}\r\n                                            name={`steps.${index}.delay_days`}\r\n                                            render={({ field }) => (\r\n                                                <FormItem>\r\n                                                    <FormLabel className=\"flex items-center gap-2\">\r\n                                                        <Clock className=\"h-3 w-3\" />\r\n                                                        Delay (Days)\r\n                                                    </FormLabel>\r\n                                                    <FormControl>\r\n                                                        <Input\r\n                                                            type=\"number\"\r\n                                                            {...field}\r\n                                                            onChange={(e) =>\r\n                                                                field.onChange(parseInt(e.target.value))\r\n                                                            }\r\n                                                        />\r\n                                                    </FormControl>\r\n                                                    <FormMessage />\r\n                                                </FormItem>\r\n                                            )}\r\n                                        />\r\n\r\n                                        <FormField\r\n                                            control={form.control}\r\n                                            name={`steps.${index}.template_id`}\r\n                                            render={({ field }) => (\r\n                                                <FormItem>\r\n                                                    <FormLabel>Select Template</FormLabel>\r\n                                                    <Select\r\n                                                        onValueChange={field.onChange}\r\n                                                        defaultValue={field.value}\r\n                                                    >\r\n                                                        <FormControl>\r\n                                                            <SelectTrigger>\r\n                                                                <SelectValue placeholder=\"Select template\" />\r\n                                                            </SelectTrigger>\r\n                                                        </FormControl>\r\n                                                        <SelectContent>\r\n                                                            {templates?.map((t) => (\r\n                                                                <SelectItem key={t.id} value={t.id}>\r\n                                                                    {t.name}\r\n                                                                </SelectItem>\r\n                                                            ))}\r\n                                                        </SelectContent>\r\n                                                    </Select>\r\n                                                    <FormMessage />\r\n                                                </FormItem>\r\n                                            )}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n\r\n                        <DialogFooter>\r\n                            <Button\r\n                                type=\"button\"\r\n                                variant=\"outline\"\r\n                                onClick={() => onOpenChange(false)}\r\n                            >\r\n                                Cancel\r\n                            </Button>\r\n                            <Button type=\"submit\" disabled={isCreating || isUpdating}>\r\n                                {(isCreating || isUpdating) && (\r\n                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                )}\r\n                                {sequence ? \"Save Changes\" : \"Create Sequence\"}\r\n                            </Button>\r\n                        </DialogFooter>\r\n                    </form>\r\n                </Form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n\r\nfunction Badge({ children, variant = \"default\" }: { children: React.ReactNode, variant?: \"default\" | \"outline\" }) {\r\n    return (\r\n        <span className={`px-2.5 py-0.5 rounded-full text-xs font-semibold ${variant === \"default\" ? \"bg-primary text-primary-foreground\" : \"border text-foreground\"\r\n            }`}>\r\n            {children}\r\n        </span>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\email\\sequence-enrollment-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\email\\template-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1810,1813],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1810,1813],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport { z } from \"zod\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport {\r\n    Form,\r\n    FormControl,\r\n    FormField,\r\n    FormItem,\r\n    FormLabel,\r\n    FormMessage,\r\n} from \"@/components/ui/form\";\r\nimport { useCreateEmailTemplate, useUpdateEmailTemplate } from \"@/hooks/use-data\";\r\nimport { toast } from \"sonner\";\r\nimport type { EmailTemplate } from \"@/types\";\r\nimport { Loader2 } from \"lucide-react\";\r\n\r\nconst templateSchema = z.object({\r\n    name: z.string().min(1, \"Template name is required\"),\r\n    subject: z.string().min(1, \"Subject is required\"),\r\n    body_html: z.string().min(1, \"Email body is required\"),\r\n    body_text: z.string().optional(),\r\n});\r\n\r\ntype TemplateFormValues = z.infer<typeof templateSchema>;\r\n\r\ninterface TemplateDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    template?: EmailTemplate | null;\r\n    organizationId: string;\r\n}\r\n\r\nexport function TemplateDialog({\r\n    open,\r\n    onOpenChange,\r\n    template,\r\n    organizationId,\r\n}: TemplateDialogProps) {\r\n    const isEditing = !!template;\r\n    const { trigger: createTemplate, isMutating: isCreating } = useCreateEmailTemplate();\r\n    const { trigger: updateTemplate, isMutating: isUpdating } = useUpdateEmailTemplate();\r\n    const isLoading = isCreating || isUpdating;\r\n\r\n    const form = useForm<TemplateFormValues>({\r\n        resolver: zodResolver(templateSchema) as any,\r\n        defaultValues: {\r\n            name: \"\",\r\n            subject: \"\",\r\n            body_html: \"\",\r\n            body_text: \"\",\r\n        },\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (template) {\r\n            form.reset({\r\n                name: template.name,\r\n                subject: template.subject,\r\n                body_html: template.body_html,\r\n                body_text: template.body_text || \"\",\r\n            });\r\n        } else {\r\n            form.reset({\r\n                name: \"\",\r\n                subject: \"\",\r\n                body_html: \"\",\r\n                body_text: \"\",\r\n            });\r\n        }\r\n    }, [template, form]);\r\n\r\n    const onSubmit = async (values: TemplateFormValues) => {\r\n        try {\r\n            if (isEditing && template) {\r\n                await updateTemplate({\r\n                    id: template.id,\r\n                    updates: values,\r\n                });\r\n                toast.success(\"Template updated successfully\");\r\n            } else {\r\n                await createTemplate({\r\n                    ...values,\r\n                    organization_id: organizationId,\r\n                });\r\n                toast.success(\"Template created successfully\");\r\n            }\r\n            onOpenChange(false);\r\n            form.reset();\r\n        } catch (error) {\r\n            console.error(\"Failed to save template:\", error);\r\n            toast.error(\"Failed to save template\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\r\n                <DialogHeader>\r\n                    <DialogTitle>\r\n                        {isEditing ? \"Edit Template\" : \"Create Template\"}\r\n                    </DialogTitle>\r\n                    <DialogDescription>\r\n                        {isEditing\r\n                            ? \"Update your email template\"\r\n                            : \"Create a new email template for your sequences\"}\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <Form {...form}>\r\n                    <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"name\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Template Name</FormLabel>\r\n                                    <FormControl>\r\n                                        <Input\r\n                                            placeholder=\"e.g., Welcome Email\"\r\n                                            {...field}\r\n                                        />\r\n                                    </FormControl>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"subject\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Subject Line</FormLabel>\r\n                                    <FormControl>\r\n                                        <Input\r\n                                            placeholder=\"e.g., Welcome to {{company_name}}!\"\r\n                                            {...field}\r\n                                        />\r\n                                    </FormControl>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"body_html\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Email Body (HTML)</FormLabel>\r\n                                    <FormControl>\r\n                                        <Textarea\r\n                                            placeholder=\"Write your email content...\"\r\n                                            className=\"min-h-[200px] font-mono text-sm\"\r\n                                            {...field}\r\n                                        />\r\n                                    </FormControl>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <FormField\r\n                            control={form.control}\r\n                            name=\"body_text\"\r\n                            render={({ field }) => (\r\n                                <FormItem>\r\n                                    <FormLabel>Plain Text Version (Optional)</FormLabel>\r\n                                    <FormControl>\r\n                                        <Textarea\r\n                                            placeholder=\"Plain text fallback...\"\r\n                                            className=\"min-h-[100px]\"\r\n                                            {...field}\r\n                                        />\r\n                                    </FormControl>\r\n                                    <FormMessage />\r\n                                </FormItem>\r\n                            )}\r\n                        />\r\n\r\n                        <DialogFooter>\r\n                            <Button\r\n                                type=\"button\"\r\n                                variant=\"outline\"\r\n                                onClick={() => onOpenChange(false)}\r\n                            >\r\n                                Cancel\r\n                            </Button>\r\n                            <Button type=\"submit\" disabled={isLoading}>\r\n                                {isLoading && (\r\n                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                )}\r\n                                {isEditing ? \"Save Changes\" : \"Create Template\"}\r\n                            </Button>\r\n                        </DialogFooter>\r\n                    </form>\r\n                </Form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\providers\\sip-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\providers\\theme-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\team\\add-member-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\team\\invite-member-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\command.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\sonner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\hooks\\use-data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\lib\\services\\sip-service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":287,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":287,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9981,9984],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9981,9984],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[512,515],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[512,515],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3861,3864],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3861,3864],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":161,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5514,5517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5514,5517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":168,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5881,5884],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5881,5884],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import JsSIP from \"jssip\";\r\nimport { useDialerStore } from \"@/lib/stores\";\r\n\r\nexport interface SipConfig {\r\n    uri: string;\r\n    password?: string;\r\n    ws_servers: string | string[];\r\n    display_name?: string;\r\n}\r\n\r\n// Declare global type for window storage\r\ndeclare global {\r\n    interface Window {\r\n        __SIP_SERVICE__?: SipService;\r\n    }\r\n}\r\n\r\nexport class SipService {\r\n    private ua: JsSIP.UA | null = null;\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    private session: any | null = null;\r\n    private _isConnected: boolean = false;\r\n    private _isRegistered: boolean = false;\r\n    private _isHangingUp: boolean = false; // Track intentional hangups\r\n\r\n    private constructor() {\r\n        // Private constructor for singleton\r\n    }\r\n\r\n    public static getInstance(): SipService {\r\n        // Use window to persist across hot reloads\r\n        if (typeof window !== \"undefined\") {\r\n            if (!window.__SIP_SERVICE__) {\r\n                window.__SIP_SERVICE__ = new SipService();\r\n            }\r\n            return window.__SIP_SERVICE__;\r\n        }\r\n        // Fallback for SSR\r\n        return new SipService();\r\n    }\r\n\r\n    public get isConnected() {\r\n        return this._isConnected;\r\n    }\r\n\r\n    public get isRegistered() {\r\n        return this._isRegistered;\r\n    }\r\n\r\n    public get hasUA() {\r\n        return !!this.ua;\r\n    }\r\n\r\n    public async connect(config: SipConfig) {\r\n        if (typeof window === \"undefined\") return;\r\n\r\n        // Don't reconnect if already connected\r\n        if (this.ua && this._isConnected) {\r\n            console.log(\"[SIP] Already connected, skipping reconnect\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const wsServer = Array.isArray(config.ws_servers) ? config.ws_servers[0] : config.ws_servers;\r\n            console.log(`[SIP] Creating UA for ${config.uri} via ${wsServer}`);\r\n\r\n            const socket = new JsSIP.WebSocketInterface(wsServer);\r\n\r\n            this.ua = new JsSIP.UA({\r\n                uri: config.uri,\r\n                password: config.password,\r\n                display_name: config.display_name,\r\n                sockets: [socket],\r\n                register: true,\r\n            });\r\n\r\n            console.log(\"[SIP] UA created, setting up handlers...\");\r\n            this.setupEventHandlers();\r\n            this.ua.start();\r\n            console.log(\"[SIP] UA started, hasUA:\", !!this.ua);\r\n        } catch (error) {\r\n            console.error(\"Failed to initialize SIP UA:\", error);\r\n            this.enableDemoMode();\r\n        }\r\n    }\r\n\r\n    public disconnect() {\r\n        if (this.ua) {\r\n            this.ua.stop();\r\n            this.ua = null;\r\n        }\r\n        this._isConnected = false;\r\n        this._isRegistered = false;\r\n    }\r\n\r\n    public call(target: string) {\r\n        if (!this.ua || !this._isRegistered) {\r\n            console.warn(\"SIP UA not ready. Using demo mode.\", {\r\n                hasUA: !!this.ua,\r\n                isRegistered: this._isRegistered,\r\n                isConnected: this._isConnected\r\n            });\r\n            this.simulateCall(target);\r\n            return;\r\n        }\r\n\r\n        // Create or get audio element for remote stream\r\n        let remoteAudio = document.getElementById(\"sip-remote-audio\") as HTMLAudioElement;\r\n        if (!remoteAudio) {\r\n            remoteAudio = document.createElement(\"audio\");\r\n            remoteAudio.id = \"sip-remote-audio\";\r\n            remoteAudio.autoplay = true;\r\n            document.body.appendChild(remoteAudio);\r\n        }\r\n\r\n        const eventHandlers = {\r\n            progress: () => {\r\n                console.log(\"[SIP] Call progress - ringing\");\r\n                useDialerStore.getState().setCallStatus(\"ringing\");\r\n            },\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            failed: (e: any) => {\r\n                // Don't show errors for user-initiated hangups\r\n                if (this._isHangingUp) {\r\n                    console.log(\"[SIP] Call ended by user\");\r\n                    this._isHangingUp = false;\r\n                    useDialerStore.getState().endCall();\r\n                    return;\r\n                }\r\n\r\n                const statusCode = e.message?.status_code;\r\n                const reasonPhrase = e.message?.reason_phrase;\r\n\r\n                // Log to console for debugging (not as error to avoid scaring users in dev tools)\r\n                console.log(\"[SIP] Call failed:\", {\r\n                    cause: e.cause,\r\n                    message: statusCode,\r\n                    reason: reasonPhrase,\r\n                    originator: e.originator,\r\n                });\r\n\r\n                // Emit custom event for UI to catch and display friendly message\r\n                if (typeof window !== \"undefined\") {\r\n                    window.dispatchEvent(new CustomEvent(\"sip:call:failed\", {\r\n                        detail: {\r\n                            cause: e.cause,\r\n                            message: statusCode,\r\n                            reason: reasonPhrase,\r\n                            originator: e.originator\r\n                        }\r\n                    }));\r\n                }\r\n\r\n                useDialerStore.getState().endCall();\r\n            },\r\n            ended: () => {\r\n                console.log(\"[SIP] Call ended\");\r\n                useDialerStore.getState().endCall();\r\n            },\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            confirmed: (e: any) => {\r\n                console.log(\"[SIP] Call confirmed/connected\");\r\n                useDialerStore.getState().setCallStatus(\"active\");\r\n                this.session = e.session;\r\n            },\r\n            // Handle peer connection for audio streams\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            peerconnection: (e: any) => {\r\n                console.log(\"[SIP] RTCPeerConnection established\");\r\n                const peerconnection = e.peerconnection as RTCPeerConnection;\r\n\r\n                // Handle incoming remote audio stream\r\n                peerconnection.ontrack = (event: RTCTrackEvent) => {\r\n                    console.log(\"[SIP] Remote track received:\", event.track.kind);\r\n                    if (event.track.kind === \"audio\" && remoteAudio) {\r\n                        remoteAudio.srcObject = event.streams[0];\r\n                        remoteAudio.play().catch(err => {\r\n                            console.error(\"[SIP] Failed to play remote audio:\", err);\r\n                        });\r\n                    }\r\n                };\r\n            }\r\n        };\r\n\r\n        const options = {\r\n            eventHandlers: eventHandlers,\r\n            mediaConstraints: { audio: true, video: false },\r\n            rtcOfferConstraints: { offerToReceiveAudio: true, offerToReceiveVideo: false }\r\n        };\r\n\r\n        try {\r\n            console.log(`[SIP] Calling ${target}...`);\r\n            this.session = this.ua.call(target, options);\r\n        } catch (e) {\r\n            console.error(\"Call error:\", e);\r\n            this.simulateCall(target);\r\n        }\r\n    }\r\n\r\n    public answer() {\r\n        if (this.session) {\r\n            this.session.answer({\r\n                mediaConstraints: { audio: true, video: false }\r\n            });\r\n        }\r\n    }\r\n\r\n    public hangup() {\r\n        console.log(\"[SIP] Hangup called, session exists:\", !!this.session);\r\n\r\n        // Stop the remote audio element\r\n        if (typeof document !== \"undefined\") {\r\n            const remoteAudio = document.getElementById(\"sip-remote-audio\") as HTMLAudioElement;\r\n            if (remoteAudio) {\r\n                remoteAudio.pause();\r\n                remoteAudio.srcObject = null;\r\n                console.log(\"[SIP] Remote audio stopped\");\r\n            }\r\n        }\r\n\r\n        if (this.session) {\r\n            try {\r\n                // Set flag to suppress error events from the failed handler\r\n                this._isHangingUp = true;\r\n                console.log(\"[SIP] Terminating session...\");\r\n                // Store reference and clear before terminating\r\n                const session = this.session;\r\n                this.session = null;\r\n                session.terminate();\r\n                console.log(\"[SIP] Session terminated successfully\");\r\n            } catch (err) {\r\n                // Session may already be ended, ignore errors\r\n                console.log(\"[SIP] Session already ended or error during hangup:\", err);\r\n                this._isHangingUp = false;\r\n            }\r\n        } else {\r\n            console.log(\"[SIP] No active session to terminate\");\r\n        }\r\n        // Always end the call in UI\r\n        useDialerStore.getState().endCall();\r\n    }\r\n\r\n    public sendDTMF(tone: string) {\r\n        if (this.session) {\r\n            this.session.sendDTMF(tone);\r\n        }\r\n    }\r\n\r\n    public mute(isMuted: boolean) {\r\n        if (this.session) {\r\n            if (isMuted) {\r\n                this.session.mute();\r\n            } else {\r\n                this.session.unmute();\r\n            }\r\n        }\r\n    }\r\n\r\n    private setupEventHandlers() {\r\n        if (!this.ua) return;\r\n\r\n        this.ua.on('connected', () => {\r\n            this._isConnected = true;\r\n            console.log('SIP WebSocket connected');\r\n        });\r\n\r\n        this.ua.on('disconnected', () => {\r\n            this._isConnected = false;\r\n            console.log('SIP WebSocket disconnected');\r\n        });\r\n\r\n        this.ua.on('registered', () => {\r\n            this._isRegistered = true;\r\n            console.log('SIP User Agent registered');\r\n        });\r\n\r\n        this.ua.on('unregistered', () => {\r\n            this._isRegistered = false;\r\n            console.log('SIP User Agent unregistered');\r\n        });\r\n\r\n        this.ua.on('registrationFailed', () => {\r\n            this._isRegistered = false;\r\n            console.warn('SIP Registration failed');\r\n        });\r\n\r\n        this.ua.on('newRTCSession', (data: any) => {\r\n            const session = data.session;\r\n\r\n            if (session.direction === 'incoming') {\r\n                this.session = session;\r\n\r\n                const { remote_identity } = session;\r\n                const callerNumber = remote_identity.uri.user;\r\n\r\n                const store = useDialerStore.getState();\r\n                store.setCurrentNumber(callerNumber);\r\n                store.openDialer();\r\n                store.setCallStatus(\"ringing\");\r\n\r\n                session.on('ended', () => {\r\n                    store.endCall();\r\n                    this.session = null;\r\n                });\r\n\r\n                session.on('failed', () => {\r\n                    store.endCall();\r\n                    this.session = null;\r\n                });\r\n\r\n                session.on('accepted', () => {\r\n                    store.setCallStatus(\"active\");\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    // Demo Mode Simulation\r\n    private simulateCall(target: string) {\r\n        const store = useDialerStore.getState();\r\n        store.startCall();\r\n\r\n        console.log(`[Demo] Calling ${target}...`);\r\n\r\n        // Simulate ringing after 1s\r\n        setTimeout(() => {\r\n            if (store.callStatus === 'ended') return;\r\n            store.setCallStatus(\"ringing\");\r\n            console.log(\"[Demo] Ringing...\");\r\n\r\n            // Simulate connected after 2s\r\n            setTimeout(() => {\r\n                if (store.callStatus === 'ended') return;\r\n                store.setCallStatus(\"active\");\r\n                console.log(\"[Demo] Connected!\");\r\n            }, 2000);\r\n        }, 1000);\r\n    }\r\n\r\n    public simulateIncomingCall(from: string) {\r\n        const store = useDialerStore.getState();\r\n        store.setCurrentNumber(from);\r\n        store.openDialer();\r\n        store.setCallStatus(\"ringing\");\r\n        // We set isInCall to true by using startCall, but we want status to be ringing initially\r\n        store.startCall();\r\n        store.setCallStatus(\"ringing\");\r\n    }\r\n\r\n    private enableDemoMode() {\r\n        console.log(\"SIP Service: Demo Mode Enabled\");\r\n        this._isConnected = true;\r\n        this._isRegistered = true;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\lib\\stores.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\lib\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\lib\\supabase\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\lib\\supabase\\server.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\lib\\supabase\\services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\scripts\\apply-rls.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is assigned a value but never used.","line":16,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sql' is assigned a value but never used.","line":20,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@supabase/supabase-js';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport dotenv from 'dotenv';\r\n\r\ndotenv.config({ path: '.env.local' });\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nif (!supabaseUrl || !serviceRoleKey) {\r\n    console.error('Missing Supabase environment variables');\r\n    process.exit(1);\r\n}\r\n\r\nconst supabase = createClient(supabaseUrl, serviceRoleKey);\r\n\r\nasync function applySql(filePath: string) {\r\n    try {\r\n        const sql = fs.readFileSync(filePath, 'utf8');\r\n\r\n        // Split by common separators if needed, but for RLS usually we can run as one block \r\n        // if the tool supports it. Supabase RPC might be needed if we don't have direct SQL access.\r\n        // However, usually service role can't run arbitrary SQL via the client libs.\r\n        // We might need to use the Supabase CLI or management API.\r\n\r\n        console.log(`Applying SQL from ${filePath}...`);\r\n\r\n        // NOTE: supabase-js does not have a direct sql() method.\r\n        // We would typically use the Supabase CLI: supabase db execute\r\n        // Or an edge function that has access to the DB.\r\n\r\n        console.log(\"Please run the SQL content of 'supabase/hardened_rls.sql' in your Supabase SQL Editor.\");\r\n        console.log(\"This is the safest way to apply RLS changes and triggers.\");\r\n\r\n    } catch (error) {\r\n        console.error('Error reading SQL file:', error);\r\n    }\r\n}\r\n\r\nconst sqlPath = path.join(process.cwd(), 'supabase', 'hardened_rls.sql');\r\napplySql(sqlPath);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\scripts\\audit-policies.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":58},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'checkPolicies' is defined but never used.","line":5,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is assigned a value but never used.","line":10,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nconst { createClient } = require('@supabase/supabase-js');\r\nrequire('dotenv').config({ path: '.env.local' });\r\n\r\nasync function checkPolicies() {\r\n    try {\r\n        const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n        const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\n        const supabase = createClient(supabaseUrl, supabaseServiceKey);\r\n\r\n        console.log('Fetching all policies...');\r\n        // We can check pg_policies via an RPC or try to see what's causing issues.\r\n        // Since I can't browse pg_catalog directly via rpc normally, I'll try to drop common ones in a new SQL.\r\n\r\n        // Let's create a \"Nuke all policies\" script.\r\n    } catch (err) {\r\n        console.error(err);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\scripts\\check-db.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":58},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":18}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nconst { createClient } = require('@supabase/supabase-js');\r\nrequire('dotenv').config({ path: '.env.local' });\r\n\r\nasync function checkProfiles() {\r\n    try {\r\n        const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n        const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\n        if (!supabaseUrl || !supabaseServiceKey) {\r\n            console.error('Missing Supabase environment variables');\r\n            process.exit(1);\r\n        }\r\n\r\n        const supabase = createClient(supabaseUrl, supabaseServiceKey);\r\n\r\n        console.log('Fetching profiles...');\r\n        const { data: profiles, error } = await supabase\r\n            .from('profiles')\r\n            .select('id, email, role, full_name');\r\n\r\n        if (error) {\r\n            console.error('Error fetching profiles:', error);\r\n            process.exit(1);\r\n        }\r\n\r\n        console.log('PROFILES_DATA_START');\r\n        profiles.forEach(p => {\r\n            console.log(`USER: ${p.email} | ROLE: ${p.role} | NAME: ${p.full_name} | ID: ${p.id}`);\r\n        });\r\n        console.log('PROFILES_DATA_END');\r\n\r\n        const { count: contactCount } = await supabase.from('contacts').select('*', { count: 'exact', head: true });\r\n        const { count: dealCount } = await supabase.from('deals').select('*', { count: 'exact', head: true });\r\n\r\n        console.log(`STATS: CONTACTS=${contactCount} | DEALS=${dealCount}`);\r\n        process.exit(0);\r\n    } catch (err) {\r\n        console.error('Script error:', err);\r\n        process.exit(1);\r\n    }\r\n}\r\n\r\ncheckProfiles();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\scripts\\check-ownership.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":58},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":18}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nconst { createClient } = require('@supabase/supabase-js');\r\nrequire('dotenv').config({ path: '.env.local' });\r\n\r\nasync function checkOwnership() {\r\n    try {\r\n        const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n        const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\n        const supabase = createClient(supabaseUrl, supabaseServiceKey);\r\n\r\n        console.log('--- Contacts Ownership ---');\r\n        const { data: contacts } = await supabase.from('contacts').select('id, first_name, owner_id');\r\n        contacts.forEach(c => console.log(`Contact: ${c.first_name} | Owner: ${c.owner_id}`));\r\n\r\n        console.log('\\n--- Deals Ownership ---');\r\n        const { data: deals } = await supabase.from('deals').select('id, name, owner_id');\r\n        deals.forEach(d => console.log(`Deal: ${d.name} | Owner: ${d.owner_id}`));\r\n\r\n        console.log('\\n--- Agent Profiles ---');\r\n        const { data: profiles } = await supabase.from('profiles').select('id, email, role');\r\n        profiles.forEach(p => console.log(`Profile: ${p.email} | ID: ${p.id} | Role: ${p.role}`));\r\n\r\n        process.exit(0);\r\n    } catch (err) {\r\n        console.error(err);\r\n        process.exit(1);\r\n    }\r\n}\r\ncheckOwnership();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\scripts\\verify-rls.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":26,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":58},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":1,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":16,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is assigned a value but never used.","line":16,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":32}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nconst { createClient } = require('@supabase/supabase-js');\r\nrequire('dotenv').config({ path: '.env.local' });\r\n\r\nasync function verifyRls() {\r\n    try {\r\n        const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n        const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\n        const supabase = createClient(supabaseUrl, supabaseServiceKey);\r\n\r\n        console.log('--- RLS Status Check ---');\r\n        const tables = ['contacts', 'deals', 'tasks', 'activities', 'profiles'];\r\n\r\n        for (const table of tables) {\r\n            const { data, error } = await supabase.rpc('get_table_rls_status', { table_name: table });\r\n            // Since I don't have that RPC, I'll use a direct query to pg_tables/pg_class if possible\r\n            // But I can't run arbitrary SQL via supabase-js unless I have an RPC.\r\n            // Let's try to fetch something with and without a user session.\r\n        }\r\n\r\n        // Alternative: Fetch roles for all profiles again to be sure\r\n        const { data: profiles } = await supabase.from('profiles').select('email, role');\r\n        console.log('Profiles:', profiles);\r\n\r\n        process.exit(0);\r\n    } catch (err) {\r\n        console.error(err);\r\n        process.exit(1);\r\n    }\r\n}\r\nverifyRls();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\OneDrive\\Documents\\Nano Sip\\nanosol-crm\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
